

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=&#34;auto&#34;>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/feiji.png">
  <link rel="icon" type="image/png" href="/img/feiji.png">
  <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="description" content="">
  <meta name="author" content="sunzy">
  <meta name="keywords" content="">
  <title>密码学 - 一路走到黑</title>

  <link  rel="stylesheet" href="https://cdn.staticfile.org/twitter-bootstrap/4.4.1/css/bootstrap.min.css" />


  <link  rel="stylesheet" href="https://cdn.staticfile.org/github-markdown-css/4.0.0/github-markdown.min.css" />
  <link  rel="stylesheet" href="/lib/hint/hint.min.css" />

  
    
    
      
      <link  rel="stylesheet" href="https://cdn.staticfile.org/highlight.js/10.0.0/styles/a11y-light.min.css" />
    
  

  


<!-- 主题依赖的图标库，不要自行修改 -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_ba1fz6golrf.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_kmeydafke9r.css">


<link  rel="stylesheet" href="/css/main.css" />

<!-- 自定义样式保持在最底部 -->


  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
<meta name="generator" content="Hexo 5.4.0"></head>


<body>
  <header style="height: 70vh;">
    <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand"
       href="/">&nbsp;<strong>Sunzy'blog</strong>&nbsp;</a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                首页
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                归档
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                分类
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                标签
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                关于
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/links/">
                <i class="iconfont icon-link-fill"></i>
                友链
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" data-toggle="modal" data-target="#modalSearch">&nbsp;<i
                class="iconfont icon-search"></i>&nbsp;</a>
          </li>
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" href="javascript:">&nbsp;<i
                class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

    <div class="banner intro-2" id="background" parallax=true
         style="background: url('https://i.loli.net/2020/10/24/eBR35xZYEbuzSW9.jpg') no-repeat center center;
           background-size: cover;">
      <div class="full-bg-img">
        <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
          <div class="container page-header text-center fade-in-up">
            <span class="h2" id="subtitle">
              
            </span>

            
              <div class="mt-3">
  
  
    <span class="post-meta">
      <i class="iconfont icon-date-fill" aria-hidden="true"></i>
      <time datetime="2020-12-23 16:37" pubdate>
        2020年12月23日 下午
      </time>
    </span>
  
</div>

<div class="mt-1">
  
    
    <span class="post-meta mr-2">
      <i class="iconfont icon-chart"></i>
      8.4k 字
    </span>
  

  
    
    <span class="post-meta mr-2">
      <i class="iconfont icon-clock-fill"></i>
      
      
      134
       分钟
    </span>
  

  
  
    
      <!-- 不蒜子统计文章PV -->
      <span id="busuanzi_container_page_pv" style="display: none">
        <i class="iconfont icon-eye" aria-hidden="true"></i>
        <span id="busuanzi_value_page_pv"></span> 次
      </span>
    
  
</div>

            
          </div>

          
        </div>
      </div>
    </div>
  </header>

  <main>
    
      

<div class="container-fluid">
  <div class="row">
    <div class="d-none d-lg-block col-lg-2"></div>
    <div class="col-lg-8 nopadding-md">
      <div class="container nopadding-md" id="board-ctn">
        <div class="py-5" id="board">
          <article class="post-content mx-auto" id="post">
            <!-- SEO header -->
            <h1 style="display: none">密码学</h1>
            
              <p class="note note-info">
                
                  本文最后更新于：2 个月前
                
              </p>
            
            <div class="markdown-body" id="post-body">
              <p>密码学实验课程设计</p>
<span id="more"></span>

<h1 id="一、古典密码"><a href="#一、古典密码" class="headerlink" title="一、古典密码"></a>一、古典密码</h1><h2 id="仿射密码"><a href="#仿射密码" class="headerlink" title="仿射密码"></a>仿射密码</h2><h3 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h3><p>仿射加密在本质上还是一个置换密码：如果说移位密码是一个常数级别的置换，那么，仿射加密是一个一次级别的置换</p>
<h3 id="加密原理"><a href="#加密原理" class="headerlink" title="加密原理"></a>加密原理</h3><p>假设X，Y，A，B是Z26整数环中的元素，A和B为密钥，X是原文，Y是密文</p>
<p>加密函数：Y=（AX+B）%26</p>
<p>解密函数：Y=（AX+B）%26，得到：X=（A的逆元）*（Y-B）%26</p>
<p>原理很简单，代码实现也比较简单</p>
<h3 id="代码实现"><a href="#代码实现" class="headerlink" title="代码实现"></a>代码实现</h3><p>各个函数作用</p>
<div class="hljs"><pre><code class="hljs stylus"><span class="hljs-function"><span class="hljs-title">gcd</span><span class="hljs-params">(a,b)</span></span>  求<span class="hljs-selector-tag">a</span>,b的最大公因子
<span class="hljs-function"><span class="hljs-title">findModReverse</span><span class="hljs-params">(a,m)</span></span>  计算a模m的逆元
<span class="hljs-function"><span class="hljs-title">encode</span><span class="hljs-params">(a,b,s)</span></span>       仿射加密
<span class="hljs-function"><span class="hljs-title">decode</span><span class="hljs-params">(a,b,s)</span></span>		仿射解密</code></pre></div>

<p>利用扩展的欧几里得算法求逆元</p>
<div class="hljs"><pre><code class="hljs python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">gcd</span>(<span class="hljs-params">a,b</span>):</span>  <span class="hljs-comment"># 求出最大公因数</span>
    <span class="hljs-keyword">while</span> a!=<span class="hljs-number">0</span>:
        a,b = b%a,a
    <span class="hljs-keyword">return</span> b

<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">findModReverse</span>(<span class="hljs-params">a,m</span>):</span> <span class="hljs-comment">#扩展欧几里得算法求模逆</span>
    <span class="hljs-keyword">if</span> gcd(a,m)!=<span class="hljs-number">1</span>:
        <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span>
    u1,u2,u3 = <span class="hljs-number">1</span>,<span class="hljs-number">0</span>,a
    v1,v2,v3 = <span class="hljs-number">0</span>,<span class="hljs-number">1</span>,m
    <span class="hljs-keyword">while</span> v3!=<span class="hljs-number">0</span>:
        q = u3//v3
        v1,v2,v3,u1,u2,u3 = (u1-q*v1),(u2-q*v2),(u3-q*v3),v1,v2,v3
    <span class="hljs-keyword">return</span> u1%m</code></pre></div>

<p>完整代码如下</p>
<div class="hljs"><pre><code class="hljs python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">gcd</span>(<span class="hljs-params">a,b</span>):</span>  <span class="hljs-comment"># 求出最大公因数</span>
    <span class="hljs-keyword">while</span> a!=<span class="hljs-number">0</span>:
        a,b = b%a,a
    <span class="hljs-keyword">return</span> b

<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">findModReverse</span>(<span class="hljs-params">a,m</span>):</span> <span class="hljs-comment">#扩展欧几里得算法求模逆</span>
    <span class="hljs-keyword">if</span> gcd(a,m)!=<span class="hljs-number">1</span>:
        <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span>
    u1,u2,u3 = <span class="hljs-number">1</span>,<span class="hljs-number">0</span>,a
    v1,v2,v3 = <span class="hljs-number">0</span>,<span class="hljs-number">1</span>,m
    <span class="hljs-keyword">while</span> v3!=<span class="hljs-number">0</span>:
        q = u3//v3
        v1,v2,v3,u1,u2,u3 = (u1-q*v1),(u2-q*v2),(u3-q*v3),v1,v2,v3
    <span class="hljs-keyword">return</span> u1%m

<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">encode</span>(<span class="hljs-params">a,b,s</span>):</span>
    result = <span class="hljs-string">&quot;&quot;</span>          <span class="hljs-comment"># 保存加密结果</span>
    s = s.upper()		 <span class="hljs-comment"># 全部转换为大写，方便计算</span>
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-built_in">len</span>(s)):
        s2 = <span class="hljs-built_in">chr</span>((a*(<span class="hljs-built_in">ord</span>(s[i])-<span class="hljs-number">65</span>)+b)%<span class="hljs-number">26</span> + <span class="hljs-number">65</span>)  <span class="hljs-comment">#使用加密公式 Y=（AX+B）%26</span>
        result = result +s2
    print(result.lower())

<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">decode</span>(<span class="hljs-params">a,b,s</span>):</span>
    a1 = findModReverse(a,<span class="hljs-number">26</span>)
    result = <span class="hljs-string">&quot;&quot;</span>
    s = s.upper()
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-built_in">len</span>(s)):
        s2 = <span class="hljs-built_in">chr</span>((a1 * (<span class="hljs-built_in">ord</span>(s[i]) - <span class="hljs-number">65</span> - b)) % <span class="hljs-number">26</span> + <span class="hljs-number">65</span>) <span class="hljs-comment"># 使用解密公式X=（A的逆元）*（Y-B）%26</span>
        result = result + s2
    print(result.lower())

<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">s_decode</span>(<span class="hljs-params">a,b,s</span>):</span>
    letter =<span class="hljs-string">&#x27;abcdefghijklmnopqrstuvwxyz&#x27;</span>
    letter = letter.upper()
    s = s.upper()
    result = <span class="hljs-string">&quot;&quot;</span>
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> s:
        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-built_in">len</span>(letter)):
            <span class="hljs-keyword">if</span> i == letter[(a*j+b)%<span class="hljs-number">26</span>]:
                result = result+letter[j]
    print(result.lower())

<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">main</span>():</span>										<span class="hljs-comment"># 主函数入口</span>
    answer = <span class="hljs-built_in">input</span>(<span class="hljs-string">f&#x27;请输入所需的操作：编码/E or 解码/D: &#x27;</span>)
    <span class="hljs-keyword">try</span>:
        <span class="hljs-keyword">if</span> answer.upper() == <span class="hljs-string">&#x27;E&#x27;</span>:
            a = <span class="hljs-built_in">int</span>(<span class="hljs-built_in">input</span>(<span class="hljs-string">&#x27;请输入a:&#x27;</span>))
            b = <span class="hljs-built_in">int</span>(<span class="hljs-built_in">input</span>(<span class="hljs-string">&#x27;请输入b:&#x27;</span>))
            s = <span class="hljs-built_in">input</span>(<span class="hljs-string">&#x27;请输入需要加密的字符:&#x27;</span>)
            encode(a, b, s)
        <span class="hljs-keyword">elif</span> answer.upper() == <span class="hljs-string">&#x27;D&#x27;</span>:
            a = <span class="hljs-built_in">int</span>(<span class="hljs-built_in">input</span>(<span class="hljs-string">&#x27;请输入a:&#x27;</span>))
            b = <span class="hljs-built_in">int</span>(<span class="hljs-built_in">input</span>(<span class="hljs-string">&#x27;请输入b:&#x27;</span>))
            s = <span class="hljs-built_in">input</span>(<span class="hljs-string">&#x27;请输入需要解密的字符：&#x27;</span>)
            decode(a, b, s)  <span class="hljs-comment"># 利用逆元解密</span>
            <span class="hljs-comment"># s_decode(a,b,s)   # 暴力枚举每一个字符</span>
        <span class="hljs-keyword">else</span>:
            print(<span class="hljs-string">&#x27;输入错误！&#x27;</span>)
    <span class="hljs-keyword">except</span> KeyError:
        print(<span class="hljs-string">&#x27;请勿输入空格！&#x27;</span>)

<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:
    main()
<span class="hljs-comment"># a = 7, b = 22</span>
<span class="hljs-comment"># plain = firstthesentenceandthentheevidencesaidthequeen</span>
<span class="hljs-comment"># crypto = falszztysyjzyjkywjrztyjztyynaryjkyswarztyegyyj</span></code></pre></div>

<p>加解密结果如图所示</p>
<p><img src="https://i.loli.net/2020/12/23/CqbfOdNB3mxHDt4.png" srcset="/img/loading.gif" alt="image-20201223225306141"></p>
<p><img src="https://i.loli.net/2020/12/23/CZHiL8cDjlUdvSw.png" srcset="/img/loading.gif" alt="image-20201223225317161"></p>
<h3 id="破解仿射密码"><a href="#破解仿射密码" class="headerlink" title="破解仿射密码"></a>破解仿射密码</h3><p>这里使用了加解密中的 <code>gcd</code> <code>findModReverse</code>，找出26以内且与26互素的所有数的逆元，并存放在一个列表中</p>
<div class="hljs"><pre><code class="hljs python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">findAllre</span>():</span>    <span class="hljs-comment"># 找出所有小于26且与26互素的数</span>
    re_all = []
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,<span class="hljs-number">26</span>):
        <span class="hljs-keyword">if</span> gcd(i,<span class="hljs-number">26</span>) == <span class="hljs-number">1</span>:
            res = findModReverse(i,<span class="hljs-number">26</span>)
            re_all.append(res)
    <span class="hljs-comment">#re_all.sort()</span>
    <span class="hljs-keyword">return</span> re_all</code></pre></div>

<p>完整代码如下</p>
<div class="hljs"><pre><code class="hljs python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">gcd</span>(<span class="hljs-params">a,b</span>):</span>  <span class="hljs-comment"># 求出最大公因数</span>
    <span class="hljs-keyword">while</span> a!=<span class="hljs-number">0</span>:
        a,b = b%a,a
    <span class="hljs-keyword">return</span> b

<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">findModReverse</span>(<span class="hljs-params">a,m</span>):</span> <span class="hljs-comment">#扩展欧几里得算法求模逆</span>
    <span class="hljs-keyword">if</span> gcd(a,m)!=<span class="hljs-number">1</span>:
        <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span>
    u1,u2,u3 = <span class="hljs-number">1</span>,<span class="hljs-number">0</span>,a
    v1,v2,v3 = <span class="hljs-number">0</span>,<span class="hljs-number">1</span>,m
    <span class="hljs-keyword">while</span> v3!=<span class="hljs-number">0</span>:
        q = u3//v3
        v1,v2,v3,u1,u2,u3 = (u1-q*v1),(u2-q*v2),(u3-q*v3),v1,v2,v3
    <span class="hljs-keyword">return</span> u1%m

<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">findAllre</span>():</span>    <span class="hljs-comment"># 找出所有小于26且与26互素的数</span>
    re_all = []
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,<span class="hljs-number">26</span>):
        <span class="hljs-keyword">if</span> gcd(i,<span class="hljs-number">26</span>) == <span class="hljs-number">1</span>:
            res = findModReverse(i,<span class="hljs-number">26</span>)
            re_all.append(res)
    <span class="hljs-comment">#re_all.sort()</span>
    <span class="hljs-keyword">return</span> re_all

<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">decode</span>(<span class="hljs-params">s</span>):</span>
    re_all = findAllre()
    <span class="hljs-keyword">for</span> k1 <span class="hljs-keyword">in</span> re_all:
        <span class="hljs-keyword">for</span> k2 <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-number">26</span>):
            result = <span class="hljs-string">&quot;&quot;</span>
            <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(s)):
                s2 = <span class="hljs-built_in">chr</span>(((<span class="hljs-built_in">int</span>(k1) * (<span class="hljs-built_in">ord</span>(s[i]) - <span class="hljs-number">97</span> - k2)) % <span class="hljs-number">26</span> + <span class="hljs-number">97</span>))
                result = result + s2
            print(<span class="hljs-string">&quot;k1=&quot;</span> + <span class="hljs-built_in">str</span>(findModReverse(k1,<span class="hljs-number">26</span>)) + <span class="hljs-string">&quot;, k2=&quot;</span> + <span class="hljs-built_in">str</span>(k2) + <span class="hljs-string">&quot; plaintext = &quot;</span> + result)

<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">main</span>():</span>
   <span class="hljs-comment"># criphertext = &#x27;falszztysyjzyjkywjrztyjztyynaryjkyswarztyegyyj&#x27;</span>
    criphertext = <span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;请输入要破解的密文: &quot;</span>)
    criphertext = criphertext.lower()
    print(<span class="hljs-string">&quot;---------&quot;</span>*<span class="hljs-number">3</span>+<span class="hljs-string">&quot;strat attck&quot;</span>+<span class="hljs-string">&quot;---------&quot;</span>*<span class="hljs-number">3</span>)
    decode(criphertext)

<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:
     main()</code></pre></div>

<p>效果如下</p>
<img src="https://i.loli.net/2020/12/23/lrQLWVebkuphvTK.png" srcset="/img/loading.gif" alt="image-20201223170037595" style="zoom:67%;">

<h2 id="维吉尼亚密码"><a href="#维吉尼亚密码" class="headerlink" title="维吉尼亚密码"></a>维吉尼亚密码</h2><h3 id="1-简介"><a href="#1-简介" class="headerlink" title="1.简介"></a>1.简介</h3><p><strong>维吉尼亚密码</strong>（又译<strong>维热纳尔密码</strong>）是使用一系列<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/凯撒密码">凯撒密码</a>组成密码字母表的加密算法，属于多表密码的一种简单形式。</p>
<p>维吉尼亚密码曾多次被发明。该方法最早记录在<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/吉奥万·巴蒂斯塔·贝拉索">吉奥万·巴蒂斯塔·贝拉索</a>（ Giovan Battista Bellaso）于1553年所著的书《吉奥万·巴蒂斯塔·贝拉索先生的密码》（<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/意大利语">意大利语</a>：La cifra del. Sig. Giovan Battista Bellaso）中。然而，后来在19世纪时被误传为是<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/法国">法国</a>外交官<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/布莱斯·德·维吉尼亚">布莱斯·德·维吉尼亚</a>（Blaise De Vigenère）所创造，因此现在被称为“维吉尼亚密码”。</p>
<p>维吉尼亚密码以其简单易用而著称，同时初学者通常难以破解，因而又被称为“不可破译的密码”。这也让很多人使用维吉尼亚密码来加密的目的就是为了将其破解。</p>
<h3 id="2-加解密原理"><a href="#2-加解密原理" class="headerlink" title="2.加解密原理"></a>2.加解密原理</h3><img src="https://i.loli.net/2020/12/23/DFHntXC9Ysp6dyV.png" srcset="/img/loading.gif" alt="image-20201223225441528" style="zoom:67%;">



<p>加解密代码</p>
<div class="hljs"><pre><code class="hljs python"><span class="hljs-comment"># 将密钥处理成和密文/明文一样长</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">solve_key</span>(<span class="hljs-params">s,key</span>):</span>
    nkey = key
    <span class="hljs-keyword">while</span> <span class="hljs-built_in">len</span>(nkey) &lt; <span class="hljs-built_in">len</span>(s):
        nkey = nkey+key
    nkey = nkey[:<span class="hljs-built_in">len</span>(s)]
    <span class="hljs-keyword">return</span> nkey

<span class="hljs-comment"># 加密函数</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">encode</span>(<span class="hljs-params">s,key</span>):</span>
    print(<span class="hljs-string">&#x27;加密后的结果： &#x27;</span>,end=<span class="hljs-string">&#x27;&#x27;</span>)
    s1 = s.upper()
    key1 = solve_key(s, key)
    key1 = key1.upper()

    result = <span class="hljs-string">&quot;&quot;</span>
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-built_in">len</span>(s)):
        s2 = <span class="hljs-built_in">chr</span>(<span class="hljs-built_in">abs</span>(((<span class="hljs-built_in">ord</span>(s1[i])-<span class="hljs-number">65</span>)+(<span class="hljs-built_in">ord</span>(key1[i])-<span class="hljs-number">65</span>)) % <span class="hljs-number">26</span>) + <span class="hljs-number">65</span>)
        result = result + s2
    print(result.lower())

<span class="hljs-comment"># 解密函数</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">decode</span>(<span class="hljs-params">s,key</span>):</span>
    print(<span class="hljs-string">&#x27;解密后的结果： &#x27;</span>, end=<span class="hljs-string">&#x27;&#x27;</span>)
    s1 = s.upper()
    key1 = solve_key(s, key)
    key1 = key1.upper()

    result = <span class="hljs-string">&quot;&quot;</span>
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-built_in">len</span>(s)):
        s2 = <span class="hljs-built_in">chr</span>(((<span class="hljs-built_in">ord</span>(s1[i]) - <span class="hljs-number">65</span>) - (<span class="hljs-built_in">ord</span>(key1[i]) - <span class="hljs-number">65</span>)) % <span class="hljs-number">26</span> + <span class="hljs-number">65</span>)
        result = result + s2
    print(result.lower())

<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">main</span>():</span>
    <span class="hljs-keyword">while</span> <span class="hljs-number">1</span>:
        <span class="hljs-comment"># 函数入口</span>
        answer = <span class="hljs-built_in">input</span>(<span class="hljs-string">f&#x27;请输入所需的操作：编码/E or 解码/D:  &#x27;</span>)
        <span class="hljs-keyword">try</span>:
            <span class="hljs-keyword">if</span> answer.upper() == <span class="hljs-string">&#x27;E&#x27;</span>:
                key = <span class="hljs-built_in">input</span>(<span class="hljs-string">&#x27;请输入密钥: &#x27;</span>)
                key = <span class="hljs-string">&quot;&quot;</span>.join(<span class="hljs-built_in">filter</span>(<span class="hljs-built_in">str</span>.isalpha, key))
                s = <span class="hljs-built_in">input</span>(<span class="hljs-string">&#x27;请输入明文: &#x27;</span>)
                s = <span class="hljs-string">&quot;&quot;</span>.join(<span class="hljs-built_in">filter</span>(<span class="hljs-built_in">str</span>.isalpha, s))  <span class="hljs-comment"># 将字符串中的非字母字符去掉</span>
                <span class="hljs-comment"># print(s)</span>
                encode(s, key)
            <span class="hljs-keyword">elif</span> answer.upper() == <span class="hljs-string">&#x27;D&#x27;</span>:
                key = <span class="hljs-built_in">input</span>(<span class="hljs-string">&#x27;请输入密钥: &#x27;</span>)
                key = <span class="hljs-string">&quot;&quot;</span>.join(<span class="hljs-built_in">filter</span>(<span class="hljs-built_in">str</span>.isalpha, key))
                s = <span class="hljs-built_in">input</span>(<span class="hljs-string">&#x27;请输入密文: &#x27;</span>)
                s = <span class="hljs-string">&quot;&quot;</span>.join(<span class="hljs-built_in">filter</span>(<span class="hljs-built_in">str</span>.isalpha, s))
                decode(s, key)
            <span class="hljs-keyword">else</span>:
                print(<span class="hljs-string">&#x27;输入错误！&#x27;</span>)
        <span class="hljs-keyword">except</span> KeyError:
            print(<span class="hljs-string">&#x27;请检查输入是否正确！&#x27;</span>)

<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:
    main()</code></pre></div>





<h1 id="二、序列密码"><a href="#二、序列密码" class="headerlink" title="二、序列密码"></a>二、序列密码</h1><h2 id="LFSR"><a href="#LFSR" class="headerlink" title="LFSR"></a>LFSR</h2><p>代码实现</p>
<div class="hljs"><pre><code class="hljs python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">lsrf</span>(<span class="hljs-params">inti, top</span>):</span>
    <span class="hljs-built_in">sum</span> = <span class="hljs-number">0</span>
    inti2 = <span class="hljs-string">&quot;0&quot;</span>*<span class="hljs-built_in">len</span>(inti)
    inti2 = <span class="hljs-built_in">list</span>(inti2)
    inti1 = <span class="hljs-string">&#x27;&#x27;</span>
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(inti)):
        <span class="hljs-keyword">if</span> top[i] == <span class="hljs-string">&quot;1&quot;</span>:
            <span class="hljs-built_in">sum</span> += <span class="hljs-built_in">int</span>(inti[i])
    <span class="hljs-built_in">sum</span> = <span class="hljs-built_in">sum</span> % <span class="hljs-number">2</span>
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(inti)):
        <span class="hljs-keyword">if</span> i == <span class="hljs-number">0</span>:
            inti2[i] = <span class="hljs-built_in">str</span>(<span class="hljs-built_in">sum</span>)
        <span class="hljs-keyword">else</span>:
            inti2[i] = inti[i - <span class="hljs-number">1</span>]
    inti1 = inti1.join(inti2)
    <span class="hljs-keyword">return</span> inti1

<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">main</span>():</span>
    inti_str = <span class="hljs-built_in">str</span>(<span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;请输入初始化序列：&quot;</span>))
    inti_str = inti_str[::-<span class="hljs-number">1</span>]
    inti_str_backup = inti_str
    top = <span class="hljs-built_in">str</span>(<span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;请输入本原多项式：&quot;</span>))
    top = top[::-<span class="hljs-number">1</span>]
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">2</span> ** <span class="hljs-built_in">len</span>(inti_str) + <span class="hljs-number">1</span>):
        <span class="hljs-keyword">if</span> inti_str_backup == inti_str <span class="hljs-keyword">and</span> i != <span class="hljs-number">0</span> <span class="hljs-keyword">and</span> i == <span class="hljs-number">2</span> ** <span class="hljs-built_in">len</span>(inti_str) - <span class="hljs-number">1</span>:
            print(<span class="hljs-string">&quot;第&#123;0&#125;次&quot;</span>.<span class="hljs-built_in">format</span>(i), inti_str_backup)
            print(<span class="hljs-string">&quot;是本原多项式且周期是&quot;</span> + <span class="hljs-built_in">str</span>(i))
            <span class="hljs-keyword">break</span>
        <span class="hljs-keyword">elif</span> inti_str_backup == inti_str <span class="hljs-keyword">and</span> i != <span class="hljs-number">0</span> <span class="hljs-keyword">and</span> i != <span class="hljs-number">2</span> ** <span class="hljs-built_in">len</span>(inti_str) - <span class="hljs-number">1</span>:
            print(<span class="hljs-string">&quot;第&#123;0&#125;次&quot;</span>.<span class="hljs-built_in">format</span>(i), inti_str_backup)
            print(<span class="hljs-string">&quot;不是本原多项式且周期是&quot;</span> + <span class="hljs-built_in">str</span>(i))
            <span class="hljs-keyword">break</span>
        print(<span class="hljs-string">&quot;第&#123;0&#125;次&quot;</span>.<span class="hljs-built_in">format</span>(i), inti_str_backup)
        inti_str_backup = lsrf(inti_str_backup, top)

<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:
    main()</code></pre></div>

<p>选择本原多项式和初始序列如下</p>
<div class="hljs"><pre><code class="hljs plain">100000000001000000
011100010100100101</code></pre></div>

<p>程序运行结果</p>
<p><img src="https://i.loli.net/2020/12/23/gfbRGZ57piKChWS.png" srcset="/img/loading.gif" alt="image-20201223222649800"></p>
<h2 id="RC4"><a href="#RC4" class="headerlink" title="RC4"></a>RC4</h2><p>完整代码</p>
<div class="hljs"><pre><code class="hljs python"><span class="hljs-keyword">import</span> hashlib
<span class="hljs-keyword">import</span> base64

<span class="hljs-comment"># S盒初始化置换,Key为密钥</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">Rc4_init</span>(<span class="hljs-params">S, Key</span>):</span>
    j = <span class="hljs-number">0</span>
    Key = Key.encode(<span class="hljs-string">&#x27;UTF-8&#x27;</span>)
    Key = hashlib.md5(Key).hexdigest()  <span class="hljs-comment"># 长度为32的字符串</span>
    tmp = []
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>):
        S.append(i)
        tmp.append(Key[i % <span class="hljs-built_in">len</span>(Key)])
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>):
        j = (j + S[i] + <span class="hljs-built_in">ord</span>(tmp[i])) % <span class="hljs-number">256</span>
        S[i], S[j] = S[j], S[i]             <span class="hljs-comment"># 交换S[i],S[j]</span>

<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">rc4_Encode</span>(<span class="hljs-params">S, plaintext</span>):</span>
    i = j = <span class="hljs-number">0</span>
    result = <span class="hljs-string">&#x27;&#x27;</span>
    <span class="hljs-keyword">for</span> a <span class="hljs-keyword">in</span> plaintext:
        i = (i + <span class="hljs-number">1</span>) % <span class="hljs-number">256</span>
        j = (j + S[i]) % <span class="hljs-number">256</span>
        S[i], S[j] = S[j], S[i]
        t = (S[i] + S[j]) % <span class="hljs-number">256</span>
        k = <span class="hljs-built_in">chr</span>(<span class="hljs-built_in">ord</span>(a) ^ S[t])
        result += k
    result = base64.b64encode(result.encode(<span class="hljs-string">&#x27;UTF-8&#x27;</span>))
    result = result.decode()
    <span class="hljs-keyword">return</span> result


<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">rc4_Decode</span>(<span class="hljs-params">S, criphtext</span>):</span>
    i = j = <span class="hljs-number">0</span>
    criphtext = base64.b64decode(criphtext)
    criphtext = <span class="hljs-built_in">str</span>(criphtext.decode())
    result = <span class="hljs-string">&#x27;&#x27;</span>
    <span class="hljs-keyword">for</span> a <span class="hljs-keyword">in</span> criphtext:
        i = (i + <span class="hljs-number">1</span>) % <span class="hljs-number">256</span>
        j = (j + S[i]) % <span class="hljs-number">256</span>
        S[i], S[j] = S[j], S[i]
        t = (S[i] + S[j]) % <span class="hljs-number">256</span>
        k = <span class="hljs-built_in">chr</span>(<span class="hljs-built_in">ord</span>(a) ^ S[t])
        result += k
    <span class="hljs-keyword">return</span> result

<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">main</span>():</span>
    <span class="hljs-keyword">while</span> <span class="hljs-number">1</span>:
        order = <span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;请输入指令,加密/E,解密/D :&quot;</span>)
        <span class="hljs-keyword">if</span> order.upper() ==<span class="hljs-string">&#x27;E&#x27;</span>:
            plaintext = <span class="hljs-built_in">input</span>(<span class="hljs-string">&#x27;请输入明文: &#x27;</span>)
            key = <span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;请输入密钥: &quot;</span>)
            s = []
            Rc4_init(s, key)
            cryphtext = rc4_Encode(s, plaintext)
            print(<span class="hljs-string">&quot;密文为: &quot;</span>, cryphtext)
            print(<span class="hljs-string">&#x27;\n&#x27;</span>)

        <span class="hljs-keyword">else</span>:
            cryphtext = <span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;请输入密文: &quot;</span>)
            key = <span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;请输入密钥: &quot;</span>)
            s = []
            Rc4_init(s, key)
            plaintext = rc4_Decode(s, cryphtext)
            print(<span class="hljs-string">&quot;明文为: &quot;</span>, plaintext)
            print(<span class="hljs-string">&#x27;\n&#x27;</span>)
<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:
    main()</code></pre></div>



<h1 id="三、DES"><a href="#三、DES" class="headerlink" title="三、DES"></a>三、DES</h1><p>DEC_ECB模式</p>
<div class="hljs"><pre><code class="hljs python"><span class="hljs-comment"># 两字符进行异或运算</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">xor</span>(<span class="hljs-params">str1, str2</span>):</span>
    res = <span class="hljs-string">&quot;&quot;</span>
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-built_in">len</span>(str1)):
        xor_res = <span class="hljs-built_in">int</span>(str1[i], <span class="hljs-number">10</span>)^<span class="hljs-built_in">int</span>(str2[i], <span class="hljs-number">10</span>)
        <span class="hljs-keyword">if</span> xor_res == <span class="hljs-number">1</span>:
            res += <span class="hljs-string">&#x27;1&#x27;</span>
        <span class="hljs-keyword">else</span>:
            res += <span class="hljs-string">&#x27;0&#x27;</span>
    <span class="hljs-keyword">return</span> res

<span class="hljs-comment"># 处理字符串，将每个字符串都转成八位二进制数</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">str_process</span>(<span class="hljs-params"><span class="hljs-built_in">str</span></span>):</span>
    res = <span class="hljs-string">&quot;&quot;</span>
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">str</span>:
        tmp = <span class="hljs-built_in">bin</span>(<span class="hljs-built_in">ord</span>(i))[<span class="hljs-number">2</span>:]
        tmp = (<span class="hljs-number">8</span> - <span class="hljs-built_in">len</span>(tmp)) * <span class="hljs-string">&#x27;0&#x27;</span> + tmp  <span class="hljs-comment"># 不够八位则在前面补 0</span>
        res += tmp
    <span class="hljs-keyword">return</span> res

<span class="hljs-comment"># PC-1盒处理</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">key_change_1</span>(<span class="hljs-params"><span class="hljs-built_in">str</span></span>):</span>
    change_table = [<span class="hljs-number">57</span>,<span class="hljs-number">49</span>,<span class="hljs-number">41</span>,<span class="hljs-number">33</span>,<span class="hljs-number">25</span>,<span class="hljs-number">17</span>,<span class="hljs-number">9</span>,<span class="hljs-number">1</span>,
                 <span class="hljs-number">58</span>,<span class="hljs-number">50</span>,<span class="hljs-number">42</span>,<span class="hljs-number">34</span>,<span class="hljs-number">26</span>,<span class="hljs-number">18</span>,<span class="hljs-number">10</span>,
                 <span class="hljs-number">2</span>,<span class="hljs-number">59</span>,<span class="hljs-number">51</span>,<span class="hljs-number">43</span>,<span class="hljs-number">35</span>,<span class="hljs-number">27</span>,<span class="hljs-number">19</span>,<span class="hljs-number">11</span>,
                 <span class="hljs-number">3</span>,<span class="hljs-number">60</span>,<span class="hljs-number">52</span>,<span class="hljs-number">44</span>,<span class="hljs-number">36</span>,<span class="hljs-number">63</span>,<span class="hljs-number">55</span>,<span class="hljs-number">47</span>,
                 <span class="hljs-number">39</span>,<span class="hljs-number">31</span>,<span class="hljs-number">23</span>,<span class="hljs-number">15</span>,<span class="hljs-number">7</span>,<span class="hljs-number">62</span>,<span class="hljs-number">54</span>,<span class="hljs-number">46</span>,
                 <span class="hljs-number">38</span>,<span class="hljs-number">30</span>,<span class="hljs-number">22</span>,<span class="hljs-number">14</span>,<span class="hljs-number">6</span>,<span class="hljs-number">61</span>,<span class="hljs-number">53</span>,<span class="hljs-number">45</span>,
                 <span class="hljs-number">37</span>,<span class="hljs-number">29</span>,<span class="hljs-number">21</span>,<span class="hljs-number">13</span>,<span class="hljs-number">5</span>,<span class="hljs-number">28</span>,<span class="hljs-number">20</span>,<span class="hljs-number">12</span>,<span class="hljs-number">4</span>]
    res = <span class="hljs-string">&quot;&quot;</span>
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> change_table:
        res += <span class="hljs-built_in">str</span>[i-<span class="hljs-number">1</span>]
    <span class="hljs-keyword">return</span> res

<span class="hljs-comment"># PC-2盒处理</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">key_change_2</span>(<span class="hljs-params"><span class="hljs-built_in">str</span></span>):</span>
    change_table = [<span class="hljs-number">14</span>,<span class="hljs-number">17</span>,<span class="hljs-number">11</span>,<span class="hljs-number">24</span>,<span class="hljs-number">1</span>,<span class="hljs-number">5</span>,<span class="hljs-number">3</span>,<span class="hljs-number">28</span>,
                 <span class="hljs-number">15</span>,<span class="hljs-number">6</span>,<span class="hljs-number">21</span>,<span class="hljs-number">10</span>,<span class="hljs-number">23</span>,<span class="hljs-number">19</span>,<span class="hljs-number">12</span>,<span class="hljs-number">4</span>,
                 <span class="hljs-number">26</span>,<span class="hljs-number">8</span>,<span class="hljs-number">16</span>,<span class="hljs-number">7</span>,<span class="hljs-number">27</span>,<span class="hljs-number">20</span>,<span class="hljs-number">13</span>,<span class="hljs-number">2</span>,
                 <span class="hljs-number">41</span>,<span class="hljs-number">52</span>,<span class="hljs-number">31</span>,<span class="hljs-number">37</span>,<span class="hljs-number">47</span>,<span class="hljs-number">55</span>,<span class="hljs-number">30</span>,<span class="hljs-number">40</span>,
                 <span class="hljs-number">51</span>,<span class="hljs-number">45</span>,<span class="hljs-number">33</span>,<span class="hljs-number">48</span>,<span class="hljs-number">44</span>,<span class="hljs-number">49</span>,<span class="hljs-number">39</span>,<span class="hljs-number">56</span>,
                 <span class="hljs-number">34</span>,<span class="hljs-number">53</span>,<span class="hljs-number">46</span>,<span class="hljs-number">42</span>,<span class="hljs-number">50</span>,<span class="hljs-number">36</span>,<span class="hljs-number">29</span>,<span class="hljs-number">32</span>]
    res = <span class="hljs-string">&quot;&quot;</span>
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> change_table:
        res += <span class="hljs-built_in">str</span>[i-<span class="hljs-number">1</span>]
    <span class="hljs-keyword">return</span> res


<span class="hljs-comment"># 循环左移</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">left_run</span>(<span class="hljs-params"><span class="hljs-built_in">str</span>, num</span>):</span>
    tmp_str = <span class="hljs-built_in">str</span>[num:<span class="hljs-built_in">len</span>(<span class="hljs-built_in">str</span>)]
    tmp_str = tmp_str+<span class="hljs-built_in">str</span>[<span class="hljs-number">0</span>:num]
    <span class="hljs-keyword">return</span> tmp_str


<span class="hljs-comment"># 生成16个子密钥</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">key_gen</span>(<span class="hljs-params"><span class="hljs-built_in">str</span></span>):</span>
    key_list = []
    key_change_res = key_change_1(<span class="hljs-built_in">str</span>)
    key_c = key_change_res[<span class="hljs-number">0</span>:<span class="hljs-number">28</span>]
    key_d = key_change_res[<span class="hljs-number">28</span>:]
    num = [<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">2</span>, <span class="hljs-number">2</span>, <span class="hljs-number">2</span>, <span class="hljs-number">2</span>, <span class="hljs-number">2</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">2</span>, <span class="hljs-number">2</span>, <span class="hljs-number">2</span>, <span class="hljs-number">2</span>, <span class="hljs-number">2</span>, <span class="hljs-number">1</span>]
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, <span class="hljs-number">17</span>): <span class="hljs-comment">#共16轮</span>
        key_c = left_run(key_c, num[i])
        key_d = left_run(key_d, num[i])
        key_yiwei = key_c + key_d
        key_res = key_change_2(key_yiwei)
        key_list.append(key_res)
    <span class="hljs-keyword">return</span> key_list

<span class="hljs-comment"># IP盒处理</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">begin_change</span>(<span class="hljs-params"><span class="hljs-built_in">str</span></span>):</span>
    change_table = [<span class="hljs-number">58</span>,<span class="hljs-number">50</span>,<span class="hljs-number">42</span>,<span class="hljs-number">34</span>,<span class="hljs-number">26</span>,<span class="hljs-number">18</span>,<span class="hljs-number">10</span>,<span class="hljs-number">2</span>,
                   <span class="hljs-number">60</span>,<span class="hljs-number">52</span>,<span class="hljs-number">44</span>,<span class="hljs-number">36</span>,<span class="hljs-number">28</span>,<span class="hljs-number">20</span>,<span class="hljs-number">12</span>,<span class="hljs-number">4</span>,
                   <span class="hljs-number">62</span>,<span class="hljs-number">54</span>,<span class="hljs-number">46</span>,<span class="hljs-number">38</span>,<span class="hljs-number">30</span>,<span class="hljs-number">22</span>,<span class="hljs-number">14</span>,<span class="hljs-number">6</span>,
                   <span class="hljs-number">64</span>,<span class="hljs-number">56</span>,<span class="hljs-number">48</span>,<span class="hljs-number">40</span>,<span class="hljs-number">32</span>,<span class="hljs-number">24</span>,<span class="hljs-number">16</span>,<span class="hljs-number">8</span>,
                   <span class="hljs-number">57</span>,<span class="hljs-number">49</span>,<span class="hljs-number">41</span>,<span class="hljs-number">33</span>,<span class="hljs-number">25</span>,<span class="hljs-number">17</span>,<span class="hljs-number">9</span>,<span class="hljs-number">1</span>,
                   <span class="hljs-number">59</span>,<span class="hljs-number">51</span>,<span class="hljs-number">43</span>,<span class="hljs-number">35</span>,<span class="hljs-number">27</span>,<span class="hljs-number">19</span>,<span class="hljs-number">11</span>,<span class="hljs-number">3</span>,
                   <span class="hljs-number">61</span>,<span class="hljs-number">53</span>,<span class="hljs-number">45</span>,<span class="hljs-number">37</span>,<span class="hljs-number">29</span>,<span class="hljs-number">21</span>,<span class="hljs-number">13</span>,<span class="hljs-number">5</span>,
                   <span class="hljs-number">63</span>,<span class="hljs-number">55</span>,<span class="hljs-number">47</span>,<span class="hljs-number">39</span>,<span class="hljs-number">31</span>,<span class="hljs-number">23</span>,<span class="hljs-number">15</span>,<span class="hljs-number">7</span>]
    res = <span class="hljs-string">&quot;&quot;</span>
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> change_table:
        res += <span class="hljs-built_in">str</span>[i-<span class="hljs-number">1</span>]
    <span class="hljs-keyword">return</span> res


<span class="hljs-comment"># E盒处理  32位-&gt;48位</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">E_box</span>(<span class="hljs-params"><span class="hljs-built_in">str</span></span>):</span>
    change_table = [<span class="hljs-number">32</span>,<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>,<span class="hljs-number">5</span>,<span class="hljs-number">4</span>,<span class="hljs-number">5</span>,
                    <span class="hljs-number">6</span>,<span class="hljs-number">7</span>,<span class="hljs-number">8</span>,<span class="hljs-number">9</span>,<span class="hljs-number">8</span>,<span class="hljs-number">9</span>,<span class="hljs-number">10</span>,<span class="hljs-number">11</span>,
                    <span class="hljs-number">12</span>,<span class="hljs-number">13</span>,<span class="hljs-number">12</span>,<span class="hljs-number">13</span>,<span class="hljs-number">14</span>,<span class="hljs-number">15</span>,<span class="hljs-number">16</span>,<span class="hljs-number">17</span>,
                    <span class="hljs-number">16</span>,<span class="hljs-number">17</span>,<span class="hljs-number">18</span>,<span class="hljs-number">19</span>,<span class="hljs-number">20</span>,<span class="hljs-number">21</span>,<span class="hljs-number">20</span>,<span class="hljs-number">21</span>,
                    <span class="hljs-number">22</span>,<span class="hljs-number">23</span>,<span class="hljs-number">24</span>,<span class="hljs-number">25</span>,<span class="hljs-number">24</span>,<span class="hljs-number">25</span>,<span class="hljs-number">26</span>,<span class="hljs-number">27</span>,
                    <span class="hljs-number">28</span>,<span class="hljs-number">29</span>,<span class="hljs-number">28</span>,<span class="hljs-number">29</span>,<span class="hljs-number">30</span>,<span class="hljs-number">31</span>,<span class="hljs-number">32</span>,<span class="hljs-number">1</span>]
    res = <span class="hljs-string">&quot;&quot;</span>
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> change_table:
        res += <span class="hljs-built_in">str</span>[i-<span class="hljs-number">1</span>]
    <span class="hljs-keyword">return</span> res

<span class="hljs-comment"># s盒处理   48位-&gt;32位</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">S_box</span>(<span class="hljs-params"><span class="hljs-built_in">str</span></span>):</span>
    j = <span class="hljs-number">0</span>
    s_list = [[<span class="hljs-number">14</span>,<span class="hljs-number">4</span>,<span class="hljs-number">13</span>,<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">15</span>,<span class="hljs-number">11</span>,<span class="hljs-number">8</span>,<span class="hljs-number">3</span>,<span class="hljs-number">10</span>,<span class="hljs-number">6</span>,<span class="hljs-number">12</span>,<span class="hljs-number">5</span>,<span class="hljs-number">9</span>,<span class="hljs-number">0</span>,<span class="hljs-number">7</span>,<span class="hljs-number">0</span>,<span class="hljs-number">15</span>,<span class="hljs-number">7</span>,<span class="hljs-number">4</span>,<span class="hljs-number">14</span>,<span class="hljs-number">2</span>,<span class="hljs-number">13</span>,<span class="hljs-number">1</span>,<span class="hljs-number">10</span>,<span class="hljs-number">6</span>,<span class="hljs-number">12</span>,<span class="hljs-number">11</span>,<span class="hljs-number">9</span>,<span class="hljs-number">5</span>,<span class="hljs-number">3</span>,<span class="hljs-number">8</span>,<span class="hljs-number">4</span>,<span class="hljs-number">1</span>,<span class="hljs-number">14</span>,<span class="hljs-number">8</span>,<span class="hljs-number">13</span>,<span class="hljs-number">6</span>,<span class="hljs-number">2</span>,<span class="hljs-number">11</span>,<span class="hljs-number">15</span>,<span class="hljs-number">12</span>,<span class="hljs-number">9</span>,<span class="hljs-number">7</span>,<span class="hljs-number">3</span>,<span class="hljs-number">10</span>,<span class="hljs-number">5</span>,<span class="hljs-number">0</span>,<span class="hljs-number">15</span>,<span class="hljs-number">12</span>,<span class="hljs-number">8</span>,<span class="hljs-number">2</span>,<span class="hljs-number">4</span>,<span class="hljs-number">9</span>,<span class="hljs-number">1</span>,<span class="hljs-number">7</span>,<span class="hljs-number">5</span>,<span class="hljs-number">11</span>,<span class="hljs-number">3</span>,<span class="hljs-number">14</span>,<span class="hljs-number">10</span>,<span class="hljs-number">0</span>,<span class="hljs-number">6</span>,<span class="hljs-number">13</span>],
              [<span class="hljs-number">15</span>,<span class="hljs-number">1</span>,<span class="hljs-number">8</span>,<span class="hljs-number">14</span>,<span class="hljs-number">6</span>,<span class="hljs-number">11</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>,<span class="hljs-number">9</span>,<span class="hljs-number">7</span>,<span class="hljs-number">2</span>,<span class="hljs-number">13</span>,<span class="hljs-number">12</span>,<span class="hljs-number">0</span>,<span class="hljs-number">5</span>,<span class="hljs-number">10</span>,<span class="hljs-number">3</span>,<span class="hljs-number">13</span>,<span class="hljs-number">4</span>,<span class="hljs-number">7</span>,<span class="hljs-number">15</span>,<span class="hljs-number">2</span>,<span class="hljs-number">8</span>,<span class="hljs-number">14</span>,<span class="hljs-number">12</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">10</span>,<span class="hljs-number">6</span>,<span class="hljs-number">9</span>,<span class="hljs-number">11</span>,<span class="hljs-number">5</span>,<span class="hljs-number">0</span>,<span class="hljs-number">14</span>,<span class="hljs-number">7</span>,<span class="hljs-number">11</span>,<span class="hljs-number">10</span>,<span class="hljs-number">4</span>,<span class="hljs-number">13</span>,<span class="hljs-number">1</span>,<span class="hljs-number">5</span>,<span class="hljs-number">8</span>,<span class="hljs-number">12</span>,<span class="hljs-number">6</span>,<span class="hljs-number">9</span>,<span class="hljs-number">3</span>,<span class="hljs-number">2</span>,<span class="hljs-number">15</span>,<span class="hljs-number">13</span>,<span class="hljs-number">8</span>,<span class="hljs-number">10</span>,<span class="hljs-number">1</span>,<span class="hljs-number">3</span>,<span class="hljs-number">15</span>,<span class="hljs-number">4</span>,<span class="hljs-number">2</span>,<span class="hljs-number">11</span>,<span class="hljs-number">6</span>,<span class="hljs-number">7</span>,<span class="hljs-number">12</span>,<span class="hljs-number">0</span>,<span class="hljs-number">5</span>,<span class="hljs-number">14</span>,<span class="hljs-number">9</span>],
              [<span class="hljs-number">10</span>,<span class="hljs-number">0</span>,<span class="hljs-number">9</span>,<span class="hljs-number">14</span>,<span class="hljs-number">6</span>,<span class="hljs-number">3</span>,<span class="hljs-number">15</span>,<span class="hljs-number">5</span>,<span class="hljs-number">1</span>,<span class="hljs-number">13</span>,<span class="hljs-number">12</span>,<span class="hljs-number">7</span>,<span class="hljs-number">11</span>,<span class="hljs-number">4</span>,<span class="hljs-number">2</span>,<span class="hljs-number">8</span>,<span class="hljs-number">13</span>,<span class="hljs-number">7</span>,<span class="hljs-number">0</span>,<span class="hljs-number">9</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>,<span class="hljs-number">6</span>,<span class="hljs-number">10</span>,<span class="hljs-number">2</span>,<span class="hljs-number">8</span>,<span class="hljs-number">5</span>,<span class="hljs-number">14</span>,<span class="hljs-number">12</span>,<span class="hljs-number">11</span>,<span class="hljs-number">15</span>,<span class="hljs-number">1</span>,<span class="hljs-number">13</span>,<span class="hljs-number">6</span>,<span class="hljs-number">4</span>,<span class="hljs-number">9</span>,<span class="hljs-number">8</span>,<span class="hljs-number">15</span>,<span class="hljs-number">3</span>,<span class="hljs-number">0</span>,<span class="hljs-number">11</span>,<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">12</span>,<span class="hljs-number">5</span>,<span class="hljs-number">10</span>,<span class="hljs-number">14</span>,<span class="hljs-number">7</span>,<span class="hljs-number">1</span>,<span class="hljs-number">10</span>,<span class="hljs-number">13</span>,<span class="hljs-number">0</span>,<span class="hljs-number">6</span>,<span class="hljs-number">9</span>,<span class="hljs-number">8</span>,<span class="hljs-number">7</span>,<span class="hljs-number">4</span>,<span class="hljs-number">15</span>,<span class="hljs-number">14</span>,<span class="hljs-number">3</span>,<span class="hljs-number">11</span>,<span class="hljs-number">5</span>,<span class="hljs-number">2</span>,<span class="hljs-number">12</span>],
              [<span class="hljs-number">7</span>,<span class="hljs-number">13</span>,<span class="hljs-number">14</span>,<span class="hljs-number">3</span>,<span class="hljs-number">0</span>,<span class="hljs-number">6</span>,<span class="hljs-number">9</span>,<span class="hljs-number">10</span>,<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">8</span>,<span class="hljs-number">5</span>,<span class="hljs-number">11</span>,<span class="hljs-number">12</span>,<span class="hljs-number">4</span>,<span class="hljs-number">15</span>,<span class="hljs-number">13</span>,<span class="hljs-number">8</span>,<span class="hljs-number">11</span>,<span class="hljs-number">5</span>,<span class="hljs-number">6</span>,<span class="hljs-number">15</span>,<span class="hljs-number">0</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>,<span class="hljs-number">7</span>,<span class="hljs-number">2</span>,<span class="hljs-number">12</span>,<span class="hljs-number">1</span>,<span class="hljs-number">10</span>,<span class="hljs-number">14</span>,<span class="hljs-number">9</span>,<span class="hljs-number">10</span>,<span class="hljs-number">6</span>,<span class="hljs-number">9</span>,<span class="hljs-number">0</span>,<span class="hljs-number">12</span>,<span class="hljs-number">11</span>,<span class="hljs-number">7</span>,<span class="hljs-number">13</span>,<span class="hljs-number">15</span>,<span class="hljs-number">1</span>,<span class="hljs-number">3</span>,<span class="hljs-number">14</span>,<span class="hljs-number">5</span>,<span class="hljs-number">2</span>,<span class="hljs-number">8</span>,<span class="hljs-number">4</span>,<span class="hljs-number">3</span>,<span class="hljs-number">15</span>,<span class="hljs-number">0</span>,<span class="hljs-number">6</span>,<span class="hljs-number">10</span>,<span class="hljs-number">1</span>,<span class="hljs-number">13</span>,<span class="hljs-number">8</span>,<span class="hljs-number">9</span>,<span class="hljs-number">4</span>,<span class="hljs-number">5</span>,<span class="hljs-number">11</span>,<span class="hljs-number">12</span>,<span class="hljs-number">7</span>,<span class="hljs-number">2</span>,<span class="hljs-number">14</span>],
              [<span class="hljs-number">2</span>,<span class="hljs-number">12</span>,<span class="hljs-number">4</span>,<span class="hljs-number">1</span>,<span class="hljs-number">7</span>,<span class="hljs-number">10</span>,<span class="hljs-number">11</span>,<span class="hljs-number">6</span>,<span class="hljs-number">8</span>,<span class="hljs-number">5</span>,<span class="hljs-number">3</span>,<span class="hljs-number">15</span>,<span class="hljs-number">13</span>,<span class="hljs-number">0</span>,<span class="hljs-number">14</span>,<span class="hljs-number">9</span>,<span class="hljs-number">14</span>,<span class="hljs-number">11</span>,<span class="hljs-number">2</span>,<span class="hljs-number">12</span>,<span class="hljs-number">4</span>,<span class="hljs-number">7</span>,<span class="hljs-number">13</span>,<span class="hljs-number">1</span>,<span class="hljs-number">5</span>,<span class="hljs-number">0</span>,<span class="hljs-number">15</span>,<span class="hljs-number">10</span>,<span class="hljs-number">3</span>,<span class="hljs-number">9</span>,<span class="hljs-number">8</span>,<span class="hljs-number">6</span>,<span class="hljs-number">4</span>,<span class="hljs-number">2</span>,<span class="hljs-number">1</span>,<span class="hljs-number">11</span>,<span class="hljs-number">10</span>,<span class="hljs-number">13</span>,<span class="hljs-number">7</span>,<span class="hljs-number">8</span>,<span class="hljs-number">15</span>,<span class="hljs-number">9</span>,<span class="hljs-number">12</span>,<span class="hljs-number">5</span>,<span class="hljs-number">6</span>,<span class="hljs-number">3</span>,<span class="hljs-number">0</span>,<span class="hljs-number">14</span>,<span class="hljs-number">11</span>,<span class="hljs-number">8</span>,<span class="hljs-number">12</span>,<span class="hljs-number">7</span>,<span class="hljs-number">1</span>,<span class="hljs-number">14</span>,<span class="hljs-number">2</span>,<span class="hljs-number">13</span>,<span class="hljs-number">6</span>,<span class="hljs-number">15</span>,<span class="hljs-number">0</span>,<span class="hljs-number">9</span>,<span class="hljs-number">10</span>,<span class="hljs-number">4</span>,<span class="hljs-number">5</span>,<span class="hljs-number">3</span>],
              [<span class="hljs-number">12</span>,<span class="hljs-number">1</span>,<span class="hljs-number">10</span>,<span class="hljs-number">15</span>,<span class="hljs-number">9</span>,<span class="hljs-number">2</span>,<span class="hljs-number">6</span>,<span class="hljs-number">8</span>,<span class="hljs-number">0</span>,<span class="hljs-number">13</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>,<span class="hljs-number">14</span>,<span class="hljs-number">7</span>,<span class="hljs-number">5</span>,<span class="hljs-number">11</span>,<span class="hljs-number">10</span>,<span class="hljs-number">15</span>,<span class="hljs-number">4</span>,<span class="hljs-number">2</span>,<span class="hljs-number">7</span>,<span class="hljs-number">12</span>,<span class="hljs-number">9</span>,<span class="hljs-number">5</span>,<span class="hljs-number">6</span>,<span class="hljs-number">1</span>,<span class="hljs-number">13</span>,<span class="hljs-number">14</span>,<span class="hljs-number">0</span>,<span class="hljs-number">11</span>,<span class="hljs-number">3</span>,<span class="hljs-number">8</span>,<span class="hljs-number">9</span>,<span class="hljs-number">14</span>,<span class="hljs-number">15</span>,<span class="hljs-number">5</span>,<span class="hljs-number">2</span>,<span class="hljs-number">8</span>,<span class="hljs-number">12</span>,<span class="hljs-number">3</span>,<span class="hljs-number">7</span>,<span class="hljs-number">0</span>,<span class="hljs-number">4</span>,<span class="hljs-number">10</span>,<span class="hljs-number">1</span>,<span class="hljs-number">13</span>,<span class="hljs-number">11</span>,<span class="hljs-number">6</span>,<span class="hljs-number">4</span>,<span class="hljs-number">3</span>,<span class="hljs-number">2</span>,<span class="hljs-number">12</span>,<span class="hljs-number">9</span>,<span class="hljs-number">5</span>,<span class="hljs-number">15</span>,<span class="hljs-number">10</span>,<span class="hljs-number">11</span>,<span class="hljs-number">14</span>,<span class="hljs-number">1</span>,<span class="hljs-number">7</span>,<span class="hljs-number">6</span>,<span class="hljs-number">0</span>,<span class="hljs-number">8</span>,<span class="hljs-number">13</span>],
              [<span class="hljs-number">4</span>,<span class="hljs-number">11</span>,<span class="hljs-number">2</span>,<span class="hljs-number">14</span>,<span class="hljs-number">15</span>,<span class="hljs-number">0</span>,<span class="hljs-number">8</span>,<span class="hljs-number">13</span>,<span class="hljs-number">3</span>,<span class="hljs-number">12</span>,<span class="hljs-number">9</span>,<span class="hljs-number">7</span>,<span class="hljs-number">5</span>,<span class="hljs-number">10</span>,<span class="hljs-number">6</span>,<span class="hljs-number">1</span>,<span class="hljs-number">13</span>,<span class="hljs-number">0</span>,<span class="hljs-number">11</span>,<span class="hljs-number">7</span>,<span class="hljs-number">4</span>,<span class="hljs-number">9</span>,<span class="hljs-number">1</span>,<span class="hljs-number">10</span>,<span class="hljs-number">14</span>,<span class="hljs-number">3</span>,<span class="hljs-number">5</span>,<span class="hljs-number">12</span>,<span class="hljs-number">2</span>,<span class="hljs-number">15</span>,<span class="hljs-number">8</span>,<span class="hljs-number">6</span>,<span class="hljs-number">1</span>,<span class="hljs-number">4</span>,<span class="hljs-number">11</span>,<span class="hljs-number">13</span>,<span class="hljs-number">12</span>,<span class="hljs-number">3</span>,<span class="hljs-number">7</span>,<span class="hljs-number">14</span>,<span class="hljs-number">10</span>,<span class="hljs-number">15</span>,<span class="hljs-number">6</span>,<span class="hljs-number">8</span>,<span class="hljs-number">0</span>,<span class="hljs-number">5</span>,<span class="hljs-number">9</span>,<span class="hljs-number">2</span>,<span class="hljs-number">6</span>,<span class="hljs-number">11</span>,<span class="hljs-number">13</span>,<span class="hljs-number">8</span>,<span class="hljs-number">1</span>,<span class="hljs-number">4</span>,<span class="hljs-number">10</span>,<span class="hljs-number">7</span>,<span class="hljs-number">9</span>,<span class="hljs-number">5</span>,<span class="hljs-number">0</span>,<span class="hljs-number">15</span>,<span class="hljs-number">14</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">12</span>],
              [<span class="hljs-number">13</span>,<span class="hljs-number">2</span>,<span class="hljs-number">8</span>,<span class="hljs-number">4</span>,<span class="hljs-number">6</span>,<span class="hljs-number">15</span>,<span class="hljs-number">11</span>,<span class="hljs-number">1</span>,<span class="hljs-number">10</span>,<span class="hljs-number">9</span>,<span class="hljs-number">3</span>,<span class="hljs-number">14</span>,<span class="hljs-number">5</span>,<span class="hljs-number">0</span>,<span class="hljs-number">12</span>,<span class="hljs-number">7</span>,<span class="hljs-number">1</span>,<span class="hljs-number">15</span>,<span class="hljs-number">13</span>,<span class="hljs-number">8</span>,<span class="hljs-number">10</span>,<span class="hljs-number">3</span>,<span class="hljs-number">7</span>,<span class="hljs-number">4</span>,<span class="hljs-number">12</span>,<span class="hljs-number">5</span>,<span class="hljs-number">6</span>,<span class="hljs-number">11</span>,<span class="hljs-number">0</span>,<span class="hljs-number">14</span>,<span class="hljs-number">9</span>,<span class="hljs-number">2</span>,<span class="hljs-number">7</span>,<span class="hljs-number">11</span>,<span class="hljs-number">4</span>,<span class="hljs-number">1</span>,<span class="hljs-number">9</span>,<span class="hljs-number">12</span>,<span class="hljs-number">14</span>,<span class="hljs-number">2</span>,<span class="hljs-number">0</span>,<span class="hljs-number">6</span>,<span class="hljs-number">10</span>,<span class="hljs-number">13</span>,<span class="hljs-number">15</span>,<span class="hljs-number">3</span>,<span class="hljs-number">5</span>,<span class="hljs-number">8</span>,<span class="hljs-number">2</span>,<span class="hljs-number">1</span>,<span class="hljs-number">14</span>,<span class="hljs-number">7</span>,<span class="hljs-number">4</span>,<span class="hljs-number">10</span>,<span class="hljs-number">8</span>,<span class="hljs-number">13</span>,<span class="hljs-number">15</span>,<span class="hljs-number">12</span>,<span class="hljs-number">9</span>,<span class="hljs-number">0</span>,<span class="hljs-number">3</span>,<span class="hljs-number">5</span>,<span class="hljs-number">6</span>,<span class="hljs-number">11</span>]
              ]
    res = <span class="hljs-string">&quot;&quot;</span>
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-built_in">len</span>(<span class="hljs-built_in">str</span>), <span class="hljs-number">6</span>):
        begin_s = <span class="hljs-built_in">str</span>[i:i + <span class="hljs-number">6</span>]
        row = <span class="hljs-built_in">int</span>(begin_s[<span class="hljs-number">0</span>] + begin_s[<span class="hljs-number">5</span>], <span class="hljs-number">2</span>)  <span class="hljs-comment">#第一位和第六位作为行</span>
        col = <span class="hljs-built_in">int</span>(begin_s[<span class="hljs-number">1</span>:<span class="hljs-number">5</span>], <span class="hljs-number">2</span>)             <span class="hljs-comment">#中间四位作为列</span>
        index = s_list[j][row * <span class="hljs-number">16</span> + col]
        num = <span class="hljs-built_in">bin</span>(index)[<span class="hljs-number">2</span>:]                   <span class="hljs-comment">#将匹配的数字转换位二进制数</span>
        <span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-number">4</span> - <span class="hljs-built_in">len</span>(num)):       <span class="hljs-comment">#不够4位则补0</span>
            num = <span class="hljs-string">&quot;0&quot;</span> + num
        res += num
        j = j + <span class="hljs-number">1</span>
    <span class="hljs-keyword">return</span> res

<span class="hljs-comment"># p盒处理   置换操作</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">P_box</span>(<span class="hljs-params"><span class="hljs-built_in">str</span></span>):</span>
    res = <span class="hljs-string">&quot;&quot;</span>
    change_table = [<span class="hljs-number">16</span>,<span class="hljs-number">7</span>,<span class="hljs-number">20</span>,<span class="hljs-number">21</span>,<span class="hljs-number">29</span>,<span class="hljs-number">12</span>,<span class="hljs-number">28</span>,<span class="hljs-number">17</span>,
                    <span class="hljs-number">1</span>,<span class="hljs-number">15</span>,<span class="hljs-number">23</span>,<span class="hljs-number">26</span>,<span class="hljs-number">5</span>,<span class="hljs-number">18</span>,<span class="hljs-number">31</span>,<span class="hljs-number">10</span>,
                    <span class="hljs-number">2</span>,<span class="hljs-number">8</span>,<span class="hljs-number">24</span>,<span class="hljs-number">14</span>,<span class="hljs-number">32</span>,<span class="hljs-number">27</span>,<span class="hljs-number">3</span>,<span class="hljs-number">9</span>,
                    <span class="hljs-number">19</span>,<span class="hljs-number">13</span>,<span class="hljs-number">30</span>,<span class="hljs-number">6</span>,<span class="hljs-number">22</span>,<span class="hljs-number">11</span>,<span class="hljs-number">4</span>,<span class="hljs-number">25</span>]
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> change_table:
        res += <span class="hljs-built_in">str</span>[i - <span class="hljs-number">1</span>]
    <span class="hljs-keyword">return</span> res

<span class="hljs-comment"># F函数</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">F_function</span>(<span class="hljs-params"><span class="hljs-built_in">str</span>, key</span>):</span>  <span class="hljs-comment"># R(32位)-&gt;E盒(48位)-&gt;与key的子密钥异或-&gt;S盒-&gt;P置换</span>
    str_e_res = E_box(<span class="hljs-built_in">str</span>)            <span class="hljs-comment"># 将 E 异或 S  P 集合到一个函数种，便于调用</span>
    xor_res = xor(str_e_res, key)
    str_s_res = S_box(xor_res)
    str_p_res = P_box(str_s_res)
    <span class="hljs-keyword">return</span> str_p_res

<span class="hljs-comment"># 逆IP盒</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">IP_re</span>(<span class="hljs-params"><span class="hljs-built_in">str</span></span>):</span>
    res = <span class="hljs-string">&quot;&quot;</span>
    ip_list = [<span class="hljs-number">40</span>,<span class="hljs-number">8</span>,<span class="hljs-number">48</span>,<span class="hljs-number">16</span>,<span class="hljs-number">56</span>,<span class="hljs-number">24</span>,<span class="hljs-number">64</span>,<span class="hljs-number">32</span>,
               <span class="hljs-number">39</span>,<span class="hljs-number">7</span>,<span class="hljs-number">47</span>,<span class="hljs-number">15</span>,<span class="hljs-number">55</span>,<span class="hljs-number">23</span>,<span class="hljs-number">63</span>,<span class="hljs-number">31</span>,
               <span class="hljs-number">38</span>,<span class="hljs-number">6</span>,<span class="hljs-number">46</span>,<span class="hljs-number">14</span>,<span class="hljs-number">54</span>,<span class="hljs-number">22</span>,<span class="hljs-number">62</span>,<span class="hljs-number">30</span>,
               <span class="hljs-number">37</span>,<span class="hljs-number">5</span>,<span class="hljs-number">45</span>,<span class="hljs-number">13</span>,<span class="hljs-number">53</span>,<span class="hljs-number">21</span>,<span class="hljs-number">61</span>,<span class="hljs-number">29</span>,
               <span class="hljs-number">36</span>,<span class="hljs-number">4</span>,<span class="hljs-number">44</span>,<span class="hljs-number">12</span>,<span class="hljs-number">52</span>,<span class="hljs-number">20</span>,<span class="hljs-number">60</span>,<span class="hljs-number">28</span>,
               <span class="hljs-number">35</span>,<span class="hljs-number">3</span>,<span class="hljs-number">43</span>,<span class="hljs-number">11</span>,<span class="hljs-number">51</span>,<span class="hljs-number">19</span>,<span class="hljs-number">59</span>,<span class="hljs-number">27</span>,
               <span class="hljs-number">34</span>,<span class="hljs-number">2</span>,<span class="hljs-number">42</span>,<span class="hljs-number">10</span>,<span class="hljs-number">50</span>,<span class="hljs-number">18</span>,<span class="hljs-number">58</span>,<span class="hljs-number">26</span>,
               <span class="hljs-number">33</span>,<span class="hljs-number">1</span>,<span class="hljs-number">41</span>,<span class="hljs-number">9</span>,<span class="hljs-number">49</span>,<span class="hljs-number">17</span>,<span class="hljs-number">57</span>,<span class="hljs-number">25</span> ]
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> ip_list:
        res += <span class="hljs-built_in">str</span>[i-<span class="hljs-number">1</span>]
    <span class="hljs-keyword">return</span> res


<span class="hljs-comment"># DES加密操作</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">DESencode</span>(<span class="hljs-params">text, key</span>):</span>
    text_bin = str_process(text)     <span class="hljs-comment"># 将字符转换为二进制数</span>
    text_IP = begin_change(text_bin)  <span class="hljs-comment"># 明文初始置换</span>
    key_bin = str_process(key)      <span class="hljs-comment"># 将密钥转换位二进制数</span>
    key_list = key_gen(key_bin) <span class="hljs-comment"># key_lsst 数组中存放着十六个子密钥</span>

    text_left = text_IP[<span class="hljs-number">0</span>:<span class="hljs-number">32</span>]     <span class="hljs-comment"># R0</span>
    text_right = text_IP[<span class="hljs-number">32</span>:]     <span class="hljs-comment"># L0</span>

    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-number">15</span>):      <span class="hljs-comment"># 十五轮加密</span>

        mes_tmp = text_right     <span class="hljs-comment"># 临时变量用于左右两部分交换</span>
        text_right = xor(F_function(text_right, key_list[i]) , text_left) <span class="hljs-comment">#F 函数的作用 R(32位)-&gt;E盒(48位)-&gt;与key的子密钥异或(32位)-&gt;S盒(32位)-&gt;P置换(32位)</span>
        text_left = mes_tmp
    fin_right = text_right       <span class="hljs-comment"># 第十六轮加密</span>
    fin_left = xor(F_function(text_right, key_list[<span class="hljs-number">15</span>]), text_left)
    criph_text = fin_left + fin_right
    criph_text = IP_re(criph_text)     <span class="hljs-comment">#  IP逆置换</span>
    <span class="hljs-keyword">return</span> criph_text

<span class="hljs-comment"># 针对一组的解密程序</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">DESdecode</span>(<span class="hljs-params">text, key</span>):</span>  <span class="hljs-comment">#密文直接输64位2进制</span>
    key_bin = str_process(key)    <span class="hljs-comment"># 将密钥转换为二进制数</span>
    key_list = key_gen(key_bin)   <span class="hljs-comment"># 生成的十六个子密钥</span>
    text = begin_change(text)   <span class="hljs-comment"># 先初始值换 与加密过程相反</span>
    cipher_left = text[<span class="hljs-number">0</span>:<span class="hljs-number">32</span>]    <span class="hljs-comment"># R16</span>
    cipher_right = text[<span class="hljs-number">32</span>:]    <span class="hljs-comment"># L16</span>
    i = <span class="hljs-number">15</span>
    <span class="hljs-keyword">while</span> i &gt; <span class="hljs-number">0</span>:                <span class="hljs-comment"># 十五轮加密 反过来</span>
        cipher_tmp = cipher_right   <span class="hljs-comment">#设置一个临时变量用于后面的交换</span>
        cipher_right = xor(cipher_left, F_function(cipher_right, key_list[i]))    <span class="hljs-comment"># F 函数的作用 R(32位)-&gt;E盒(48位)-&gt;与key的子密钥异或(32位)-&gt;S盒(32位)-&gt;P置换(32位)</span>
                                                                                  <span class="hljs-comment"># F 函数处理完后与L(32位)异或</span>
        cipher_left = cipher_tmp    <span class="hljs-comment"># 左右交换完成</span>
        i = i - <span class="hljs-number">1</span>
    left_text = xor(cipher_left, F_function(cipher_right, key_list[<span class="hljs-number">0</span>])) <span class="hljs-comment"># 一</span>
    right_text = cipher_right                                           <span class="hljs-comment"># 二 三 这三步是第十六轮加密</span>
    plain_bin = left_text + right_text                                  <span class="hljs-comment">#</span>
    plain_bin = IP_re(plain_bin)                                        <span class="hljs-comment">#</span>
    plain_text = <span class="hljs-string">&quot;&quot;</span>
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-built_in">len</span>(plain_bin), <span class="hljs-number">8</span>):
        plain_text += <span class="hljs-built_in">chr</span>(<span class="hljs-built_in">int</span>(plain_bin[i:i + <span class="hljs-number">8</span>], <span class="hljs-number">2</span>))
    <span class="hljs-keyword">return</span> plain_text


<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">Divide_text</span>(<span class="hljs-params">order,text,key</span>):</span>    <span class="hljs-comment"># 将明文或者明文分组 明文分成8个字符一组，密文则分成64bit一组</span>
    block_text = []
    res = <span class="hljs-string">&quot;&quot;</span>
    length = <span class="hljs-number">0</span>
    <span class="hljs-keyword">if</span> order == <span class="hljs-string">&quot;E&quot;</span>:
        length = <span class="hljs-number">8</span>
    <span class="hljs-keyword">else</span>:
        length = <span class="hljs-number">64</span>
    i = <span class="hljs-number">0</span>
    <span class="hljs-keyword">while</span> text[i:i+length] != <span class="hljs-string">&quot;&quot;</span>:
        block_text.append(text[i:i+length])
        i += length

    <span class="hljs-keyword">if</span> order == <span class="hljs-string">&#x27;E&#x27;</span>:
        <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(block_text[-<span class="hljs-number">1</span>]) != <span class="hljs-number">8</span>:       <span class="hljs-comment"># 最后一组明文如果不够八个字符则添加 + 补齐八个  否则程序会报错</span>
            block_text[-<span class="hljs-number">1</span>] = block_text[-<span class="hljs-number">1</span>] + <span class="hljs-string">&#x27;+&#x27;</span> * (<span class="hljs-number">8</span> - <span class="hljs-built_in">len</span>(block_text[-<span class="hljs-number">1</span>]))
        <span class="hljs-keyword">for</span> text <span class="hljs-keyword">in</span> block_text:             <span class="hljs-comment"># 分别对每组加密</span>
            res += DESencode(text, key)
    <span class="hljs-keyword">else</span>:
        <span class="hljs-keyword">for</span> text <span class="hljs-keyword">in</span> block_text:             <span class="hljs-comment"># 对密文解密</span>
            res += DESdecode(text, key)
    <span class="hljs-keyword">return</span> res

<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">main</span>():</span>
    <span class="hljs-keyword">while</span> <span class="hljs-number">1</span>:
        plaintext = <span class="hljs-string">&#x27;&#x27;</span>
        ciphertext = <span class="hljs-string">&#x27;&#x27;</span>
        key = <span class="hljs-string">&#x27;&#x27;</span>
        order = <span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;加密请按E,解密请按D:&quot;</span>)
        <span class="hljs-keyword">if</span> order == <span class="hljs-string">&#x27;E&#x27;</span>:
            plaintext = <span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;请输入明文：&quot;</span>)
            key = <span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;请输入密钥：&quot;</span>)
            ciphertext = Divide_text(order, plaintext, key)
            print(<span class="hljs-string">&quot;密文是：&quot;</span>)
            print(ciphertext)
        <span class="hljs-keyword">else</span>:
            ciphertext = <span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;请输入密文：&quot;</span>)
            key = <span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;请输入密钥：&quot;</span>)
            plaintext = Divide_text(order, ciphertext, key)
            print(<span class="hljs-string">&quot;明文是：&quot;</span>)
            print(plaintext)

<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:
    main()</code></pre></div>



<p>DES_CBC模式</p>
<p>只需要修改ECB模式中的 Divide_text 部分</p>
<div class="hljs"><pre><code class="hljs python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">Divide_text</span>(<span class="hljs-params">order,text,key</span>):</span>    <span class="hljs-comment"># 将明文或者明文分组 明文分成8个字符一组，密文则分成64bit一组</span>
    block_text = []
    IV = <span class="hljs-string">&#x27;aaaaaaaa&#x27;</span>                 <span class="hljs-comment"># 初始化向量</span>
    IV_bin = str_process(IV)
    res = <span class="hljs-string">&quot;&quot;</span>
    length = <span class="hljs-number">0</span>
    <span class="hljs-keyword">if</span> order == <span class="hljs-string">&quot;E&quot;</span>:
        length = <span class="hljs-number">8</span>
    <span class="hljs-keyword">else</span>:
        length = <span class="hljs-number">64</span>
    i = <span class="hljs-number">0</span>
    <span class="hljs-keyword">while</span> text[i:i+length] != <span class="hljs-string">&quot;&quot;</span>:
        block_text.append(text[i:i+length])
        i += length
    tmp = <span class="hljs-string">&quot;&quot;</span>
    <span class="hljs-comment"># 加密</span>
    <span class="hljs-keyword">if</span> order == <span class="hljs-string">&#x27;E&#x27;</span>:
        <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(block_text[-<span class="hljs-number">1</span>]) != <span class="hljs-number">8</span>:       <span class="hljs-comment"># 最后一组明文如果不够八个字符则添加 + 补齐八个  否则程序会报错</span>
            block_text[-<span class="hljs-number">1</span>] = block_text[-<span class="hljs-number">1</span>] + <span class="hljs-string">&#x27;+&#x27;</span> * (<span class="hljs-number">8</span> - <span class="hljs-built_in">len</span>(block_text[-<span class="hljs-number">1</span>]))

        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(block_text)):             <span class="hljs-comment"># 分别对每组加密</span>
            <span class="hljs-keyword">if</span> i == <span class="hljs-number">0</span> :
                tmp = DESencode(block_text[i],key, IV_bin)
                res += tmp
            <span class="hljs-keyword">else</span>:
                tmp = DESencode(block_text[i],key,tmp)
                res += tmp
    <span class="hljs-comment"># 解密</span>
    <span class="hljs-keyword">else</span>:
        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(block_text)):
            <span class="hljs-keyword">if</span> i == <span class="hljs-number">0</span>:
                tmp = block_text[i]
                res += DESdecode(block_text[i], key, IV_bin)
            <span class="hljs-keyword">else</span>:
                res += DESdecode(block_text[i], key, tmp)
                tmp = block_text[i]
    <span class="hljs-keyword">return</span> res</code></pre></div>



<h1 id="四、RSA"><a href="#四、RSA" class="headerlink" title="四、RSA"></a>四、RSA</h1><div class="hljs"><pre><code class="hljs python"><span class="hljs-comment"># -*- coding = utf - 8 -*-</span>
<span class="hljs-comment">#@Time : 2020/12/23 14:24</span>
<span class="hljs-comment">#@Author : sunzy</span>
<span class="hljs-comment">#@File : rsa.py</span>

<span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *
<span class="hljs-keyword">import</span> random

<span class="hljs-comment"># 模重复平方法</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">fast_mod</span>(<span class="hljs-params">p,q,n</span>):</span>     <span class="hljs-comment"># p为底数，p为指数</span>
    res = <span class="hljs-number">1</span>
    <span class="hljs-keyword">while</span> q:
        <span class="hljs-keyword">if</span> q &amp; <span class="hljs-number">1</span>:
            res = (res * p) % n
        q &gt;&gt;= <span class="hljs-number">1</span>             <span class="hljs-comment"># 右移1位</span>
        p = (p * p) % n
    <span class="hljs-keyword">return</span> res

<span class="hljs-comment"># 计算出d</span>
<span class="hljs-comment">#这个扩展欧几里得算法求模逆,用于求d</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">caculateD</span>(<span class="hljs-params">a, m</span>):</span>
    u1,u2,u3 = <span class="hljs-number">1</span>,<span class="hljs-number">0</span>,a
    v1,v2,v3 = <span class="hljs-number">0</span>,<span class="hljs-number">1</span>,m
    <span class="hljs-keyword">while</span> v3!=<span class="hljs-number">0</span>:
        q = u3//v3
        v1,v2,v3,u1,u2,u3 = (u1-q*v1),(u2-q*v2),(u3-q*v3),v1,v2,v3
    <span class="hljs-keyword">return</span> u1%m


<span class="hljs-comment"># 将字符转化为十六进制字符串</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">str2Hex</span>(<span class="hljs-params">m</span>):</span>
    <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;&quot;</span>.join(<span class="hljs-string">&quot;&#123;:02x&#125;&quot;</span>.<span class="hljs-built_in">format</span>(<span class="hljs-built_in">ord</span>(x)) <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> m)

<span class="hljs-comment"># 素性检验：采用 Miler-Rabin 检验法</span>
<span class="hljs-comment"># 所有的𝑟 ∈ [0, 𝑠 − 1]，若𝑎^𝑑 ≠ 1(𝑚𝑜𝑑 𝑛)且𝑎^((2^𝑟)*𝑑) ≠ −1(𝑚𝑜𝑑 𝑛)，则𝑛是合数。否则，𝑛有 3/4的概率为素数</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">miller_rabin</span>(<span class="hljs-params">n</span>):</span>
    s = n - <span class="hljs-number">1</span>
    t = <span class="hljs-number">0</span>
    <span class="hljs-keyword">while</span> s % <span class="hljs-number">2</span> == <span class="hljs-number">0</span>:  <span class="hljs-comment"># n,s,t之间的关系为 n = 2^s * t</span>
        s = s // <span class="hljs-number">2</span>
        t += <span class="hljs-number">1</span>
    <span class="hljs-keyword">for</span> trials <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">10</span>):   <span class="hljs-comment"># 可以多增加几轮保证大概率为素数</span>
        a = random.randrange(<span class="hljs-number">2</span>, n - <span class="hljs-number">1</span>) <span class="hljs-comment"># 随机生成a</span>
        v = <span class="hljs-built_in">pow</span>(a, s, n)               <span class="hljs-comment"># 验证 a^(n-1) mod n</span>
        <span class="hljs-keyword">if</span> v != <span class="hljs-number">1</span>:
            i = <span class="hljs-number">0</span>
            <span class="hljs-keyword">while</span> v != (n - <span class="hljs-number">1</span>):
                <span class="hljs-keyword">if</span> i == t - <span class="hljs-number">1</span>:
                    <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span>
                <span class="hljs-keyword">else</span>:
                    i = i + <span class="hljs-number">1</span>
                    v = (v ** <span class="hljs-number">2</span>) % n
    <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span>
<span class="hljs-comment"># 生成素数 先生成1024位的奇数，再进行素性检验，通过则生成该素数</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">genPrime</span>(<span class="hljs-params">b=<span class="hljs-number">1024</span></span>):</span>
    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:                             <span class="hljs-comment"># 设置死循环直到生成素数才退出</span>
        res = <span class="hljs-string">&quot;1&quot;</span>
        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(b-<span class="hljs-number">2</span>):
            res += <span class="hljs-built_in">str</span>(random.randint(<span class="hljs-number">0</span>,<span class="hljs-number">1</span>))
        res += <span class="hljs-string">&quot;1&quot;</span>                              <span class="hljs-comment"># 最后一位为1保证为奇数</span>
        res = <span class="hljs-built_in">int</span>(res,<span class="hljs-number">2</span>)
        <span class="hljs-keyword">if</span> miller_rabin(res):
            <span class="hljs-keyword">return</span> res                          <span class="hljs-comment"># 直到该数通过素数检验才推出循环</span>

<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">genE</span>(<span class="hljs-params">phi_n</span>):</span>
    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:
        e = genPrime(b=random.randint(<span class="hljs-number">3</span>,<span class="hljs-number">13</span>))  <span class="hljs-comment">#随机生成e</span>
        <span class="hljs-keyword">if</span> e &lt; <span class="hljs-number">2000</span> :                  <span class="hljs-comment"># e不能太小</span>
            <span class="hljs-keyword">continue</span>
        <span class="hljs-keyword">if</span> phi_n%e != <span class="hljs-number">0</span>:               <span class="hljs-comment"># 保证e不能被phi整除</span>
            <span class="hljs-keyword">return</span> e

<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">RSAEncode</span>(<span class="hljs-params">m, e, n</span>):</span>               <span class="hljs-comment"># 加密公式 m^e mod n</span>
    m = <span class="hljs-built_in">int</span>(str2Hex(m), <span class="hljs-number">16</span>)           <span class="hljs-comment"># 将字符转换为二进制</span>
    c = fast_mod(m, e, n)
    <span class="hljs-keyword">return</span> c

<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">RSADecode</span>(<span class="hljs-params">c, d, n</span>):</span>                 <span class="hljs-comment"># 加密公式 c^d mod n</span>
    plaintext = fast_mod(c,d,n)
    plaintext = <span class="hljs-built_in">str</span>(long_to_bytes(plaintext).decode()) <span class="hljs-comment"># 将数字转换为字符</span>
    <span class="hljs-keyword">return</span> plaintext


<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">main</span>():</span>
    <span class="hljs-comment"># 生成两个大素数p和q</span>
    print(<span class="hljs-string">&quot;Generate p,q and e, please wait... &quot;</span>)
    p = genPrime()
    q = genPrime()
    <span class="hljs-built_in">print</span> (<span class="hljs-string">&quot;p = &quot;</span>+<span class="hljs-built_in">str</span>(p))
    <span class="hljs-built_in">print</span> (<span class="hljs-string">&quot;q = &quot;</span>+<span class="hljs-built_in">str</span>(q))
    n = p*q
    <span class="hljs-built_in">print</span> (<span class="hljs-string">&quot;n = &quot;</span>+<span class="hljs-built_in">str</span>(n))
    <span class="hljs-comment"># 用欧拉定理计算 phi_n</span>
    phi_n = (p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>)
    <span class="hljs-comment"># 生成e</span>
    e = genE(phi_n)
    <span class="hljs-built_in">print</span> (<span class="hljs-string">&quot;e = &quot;</span>+<span class="hljs-built_in">str</span>(e))
    <span class="hljs-comment"># m = &quot;Hello world!&quot;</span>
    m = <span class="hljs-built_in">str</span>(<span class="hljs-built_in">input</span>(<span class="hljs-string">&#x27;请输入明文: &#x27;</span>))
    <span class="hljs-comment"># 加密算法</span>
    Cryphtext = RSAEncode(m, e, n)
    <span class="hljs-built_in">print</span> (<span class="hljs-string">&quot;The Ciphertext is: &quot;</span>+<span class="hljs-built_in">str</span>(Cryphtext))
    <span class="hljs-comment"># 解密算法</span>
    d = caculateD(e, phi_n)
    Plaintext = RSADecode(Cryphtext, d, n)
    <span class="hljs-built_in">print</span> (<span class="hljs-string">&quot;The Plaintext is: &quot;</span>+Plaintext)
<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:
    main()</code></pre></div>





<h1 id="五、MD5"><a href="#五、MD5" class="headerlink" title="五、MD5"></a>五、MD5</h1><div class="hljs"><pre><code class="hljs python"><span class="hljs-comment"># -*- coding = utf - 8 -*-</span>
<span class="hljs-comment">#@Time : 2020/12/18 21:50</span>
<span class="hljs-comment">#@Author : sunzy</span>
<span class="hljs-comment">#@File : MD5.py</span>

<span class="hljs-keyword">import</span> math
<span class="hljs-comment"># 定义初始向量abcd,并将其转换成2进制,且补0到32位</span>
<span class="hljs-comment"># 标准的幻数（物理顺序）是（A=(01234567)16，B=(89ABCDEF)16，C=(FEDCBA98)16，D=(76543210)16）。如果在程序中定义应该是:</span>
<span class="hljs-comment"># （A=0X67452301L，B=0XEFCDAB89L，C=0X98BADCFEL，D=0X10325476L）</span>
ABCD_list = [<span class="hljs-string">&#x27;67452301&#x27;</span>,<span class="hljs-string">&#x27;efcdab89&#x27;</span>,<span class="hljs-string">&#x27;98badcfe&#x27;</span>,<span class="hljs-string">&#x27;10325476&#x27;</span>]
<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(ABCD_list)):
    tmp = <span class="hljs-built_in">bin</span>(<span class="hljs-built_in">int</span>(ABCD_list[i], <span class="hljs-number">16</span>))[<span class="hljs-number">2</span>:]
    <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(tmp) &lt; <span class="hljs-number">32</span>:
        tmp = (<span class="hljs-number">32</span> - <span class="hljs-built_in">len</span>(tmp)) * <span class="hljs-string">&#x27;0&#x27;</span> + tmp
    ABCD_list[i] = tmp
A0,B0,C0,D0 = ABCD_list[<span class="hljs-number">0</span>], ABCD_list[<span class="hljs-number">1</span>], ABCD_list[<span class="hljs-number">2</span>], ABCD_list[<span class="hljs-number">3</span>]

<span class="hljs-comment"># 生成第1-64个式子的第i个32比特常数</span>
Ti = []
<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-number">64</span>):
    result = (<span class="hljs-built_in">int</span>(<span class="hljs-number">4294967296</span> * <span class="hljs-built_in">abs</span>(math.sin(i + <span class="hljs-number">1</span>)))) &amp; <span class="hljs-number">0xffffffff</span>
    result = <span class="hljs-built_in">bin</span>(result)[<span class="hljs-number">2</span>:]
    <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(result) &lt; <span class="hljs-number">32</span>:
        result = (<span class="hljs-number">32</span> - <span class="hljs-built_in">len</span>(result)) * <span class="hljs-string">&#x27;0&#x27;</span> + result
    Ti.append(result)

<span class="hljs-comment"># 实现x,y的逐比特与</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">and1</span>(<span class="hljs-params">x, y</span>):</span>
    res = <span class="hljs-string">&#x27;&#x27;</span>
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-built_in">len</span>(x)):
        res += <span class="hljs-built_in">str</span>(<span class="hljs-built_in">int</span>(x[i])&amp;<span class="hljs-built_in">int</span>(y[i]))
    <span class="hljs-keyword">return</span> res
<span class="hljs-comment"># 实现x,y的逐比特或</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">or1</span>(<span class="hljs-params">x, y</span>):</span>
    res = <span class="hljs-string">&#x27;&#x27;</span>
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-built_in">len</span>(x)):
        res += <span class="hljs-built_in">str</span>(<span class="hljs-built_in">int</span>(x[i])|<span class="hljs-built_in">int</span>(y[i]))
    <span class="hljs-keyword">return</span> res
<span class="hljs-comment"># 实现x,y的逐比特异或</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">xor</span>(<span class="hljs-params">x, y</span>):</span>
    res = <span class="hljs-string">&#x27;&#x27;</span>
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-built_in">len</span>(x)):
        res += <span class="hljs-built_in">str</span>(<span class="hljs-built_in">int</span>(x[i])^<span class="hljs-built_in">int</span>(y[i]))
    <span class="hljs-keyword">return</span> res
<span class="hljs-comment"># 实现x的逐比特逻辑反</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">reverse</span>(<span class="hljs-params">x</span>):</span>
    res = <span class="hljs-string">&#x27;&#x27;</span>
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-built_in">len</span>(x)):
        res += <span class="hljs-built_in">str</span>((<span class="hljs-built_in">int</span>(x[i], <span class="hljs-number">2</span>) + <span class="hljs-number">1</span>) % <span class="hljs-number">2</span>)
    <span class="hljs-keyword">return</span> res

<span class="hljs-comment"># 实现x的循环左移</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">shift</span>(<span class="hljs-params">x, i</span>):</span>
    res = <span class="hljs-string">&#x27;&#x27;</span>
    <span class="hljs-keyword">for</span> t <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-built_in">len</span>(x) - i):
        res = res + x[t + i:t + i + <span class="hljs-number">1</span>]   <span class="hljs-comment"># 先保存 x[i:]  再保存x[:i]</span>
    <span class="hljs-keyword">for</span> y <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, i):
        res = res + x[y:y + <span class="hljs-number">1</span>]
    <span class="hljs-keyword">return</span> res

<span class="hljs-comment"># 实现整数模2的三十二次方加法</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">add</span>(<span class="hljs-params">x, y</span>):</span>
    a = <span class="hljs-built_in">int</span>(x,<span class="hljs-number">2</span>)  <span class="hljs-comment">#先将二进制转换成十进制</span>
    b = <span class="hljs-built_in">int</span>(y,<span class="hljs-number">2</span>)
    res = (a + b)%(<span class="hljs-number">2</span>**<span class="hljs-number">32</span>)
    res = <span class="hljs-built_in">str</span>(<span class="hljs-built_in">bin</span>(res)[<span class="hljs-number">2</span>:])
    <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(res) != <span class="hljs-number">32</span>:    <span class="hljs-comment"># 补充到32位</span>
        res = (<span class="hljs-number">32</span>-<span class="hljs-built_in">len</span>(res))*<span class="hljs-string">&#x27;0&#x27;</span>+res
    <span class="hljs-keyword">return</span> res

<span class="hljs-comment"># 定义f,g,h,i函数</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">ffunc</span>(<span class="hljs-params">x, y, z</span>):</span>  <span class="hljs-comment"># ((x&amp;y)|((~x)&amp;z))</span>
    t = and1(x, y)
    t1 = reverse(x)
    t2 = and1(t1, z)
    <span class="hljs-keyword">return</span> or1(t, t2)

<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">gfunc</span>(<span class="hljs-params">x, y, z</span>):</span>  <span class="hljs-comment"># ((x&amp;z)|(y&amp;(~z)))</span>
    t = and1(x, z)
    t1 = reverse(z)
    t2 = and1(y, t1)
    <span class="hljs-keyword">return</span> or1(t, t2)

<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">hfunc</span>(<span class="hljs-params">x, y, z</span>):</span> <span class="hljs-comment"># (x^y^z)</span>
    t1 = xor(x, y)
    t2 = xor(t1, z)
    <span class="hljs-keyword">return</span> t2

<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">ifunc</span>(<span class="hljs-params">x, y, z</span>):</span> <span class="hljs-comment"># (y^(x|(~z)))</span>
    t = reverse(z)
    t1 = or1(x, t)
    <span class="hljs-keyword">return</span> xor(y, t1)

<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">fill</span>(<span class="hljs-params">text</span>):</span>
    text1 = <span class="hljs-string">&#x27;&#x27;</span>
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> text:
        t = <span class="hljs-built_in">str</span>(<span class="hljs-built_in">ord</span>(i))
        t = <span class="hljs-built_in">str</span>(<span class="hljs-built_in">bin</span>(<span class="hljs-built_in">int</span>(t, <span class="hljs-number">10</span>))[<span class="hljs-number">2</span>:])
        <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(t) &lt; <span class="hljs-number">8</span>:                 <span class="hljs-comment"># 将每个字符转换成8位二进制数</span>
            <span class="hljs-keyword">for</span> num <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">8</span> - <span class="hljs-built_in">len</span>(t)):
                t = <span class="hljs-string">&#x27;0&#x27;</span> + t
        text1 = text1 + t
    length = <span class="hljs-built_in">len</span>(text1)
    length1 = <span class="hljs-number">512</span> - <span class="hljs-built_in">len</span>(text1) - <span class="hljs-number">65</span>    <span class="hljs-comment"># length1是要填充0的位数</span>
    text1 = text1 + <span class="hljs-string">&#x27;1&#x27;</span>                <span class="hljs-comment"># 第一位添加 0</span>
    text1 = text1 + <span class="hljs-string">&#x27;0&#x27;</span>*length1        <span class="hljs-comment"># 将其补充到 N*512+448  N可以为0</span>
    text2 = <span class="hljs-built_in">bin</span>(length)[<span class="hljs-number">2</span>:]            <span class="hljs-comment"># 将字符长度转换成二进制数</span>
    <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(text2) &lt; <span class="hljs-number">8</span>:                 <span class="hljs-comment">#  填充后面64位,先填充字符串的长度,再补0</span>
        text2 = <span class="hljs-string">&#x27;0&#x27;</span>*(<span class="hljs-number">8</span> - <span class="hljs-built_in">len</span>(text2)) + text2

    length2 = <span class="hljs-number">64</span> - <span class="hljs-built_in">len</span>(text2)
    text2 = text2 + <span class="hljs-string">&#x27;0&#x27;</span>*length2        <span class="hljs-comment"># 填充后面64位,先填充字符串的长度,再补0</span>
    <span class="hljs-keyword">return</span> text1 + text2

<span class="hljs-comment"># 将最后得到的ABCD逆序输出  最后一步使用</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">reverse_order</span>(<span class="hljs-params">a</span>):</span>
    res = a[<span class="hljs-number">24</span>:<span class="hljs-number">32</span>] + a[<span class="hljs-number">16</span>:<span class="hljs-number">24</span>] + a[<span class="hljs-number">8</span>:<span class="hljs-number">16</span>] + a[<span class="hljs-number">0</span>:<span class="hljs-number">8</span>]
    <span class="hljs-keyword">return</span> res

<span class="hljs-comment"># 输入要加密的明文</span>
password = <span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;请输入要加密的信息:&quot;</span>)
<span class="hljs-comment"># 填充算法</span>
x = fill(password)


j = <span class="hljs-number">0</span>
M = []
<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-built_in">len</span>(x),<span class="hljs-number">32</span>):   <span class="hljs-comment"># 将512位分成十六组</span>
    M.append(x[i:i+<span class="hljs-number">32</span>])
    M[j] = M[j][<span class="hljs-number">24</span>:<span class="hljs-number">32</span>] + M[j][<span class="hljs-number">16</span>:<span class="hljs-number">24</span>] + M[j][<span class="hljs-number">8</span>:<span class="hljs-number">16</span>] + M[j][<span class="hljs-number">0</span>:<span class="hljs-number">8</span>]
    j+=<span class="hljs-number">1</span>

<span class="hljs-comment"># md5算法的第一步</span>
A,B,C,D= A0,B0,C0,D0  <span class="hljs-comment">#为第五步 相加原始的A,B,C,D做备份</span>

<span class="hljs-comment"># md5算法的第二步</span>
AA,BB,CC,DD = A,B,C,D

<span class="hljs-comment"># md5算法的第三步</span>
<span class="hljs-comment"># 第一轮     每轮A,B,C,D都处理四次，四轮就是十六次，一共六十四次</span>
<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">4</span>):                  <span class="hljs-comment"># f函数</span>
    A = add(B, shift(add(A, add(add(ffunc(B, C, D), M[<span class="hljs-number">4</span>*i]), Ti[<span class="hljs-number">4</span> * i])), <span class="hljs-number">7</span>))
    D = add(A, shift(add(D, add(add(ffunc(A, B, C), M[<span class="hljs-number">4</span>*i+<span class="hljs-number">1</span>]), Ti[<span class="hljs-number">4</span> * i + <span class="hljs-number">1</span>])), <span class="hljs-number">12</span>))
    C = add(D, shift(add(C, add(add(ffunc(D, A, B), M[<span class="hljs-number">4</span>*i+<span class="hljs-number">2</span>]), Ti[<span class="hljs-number">4</span> * i + <span class="hljs-number">2</span>])), <span class="hljs-number">17</span>))
    B = add(C, shift(add(B, add(add(ffunc(C, D, A), M[<span class="hljs-number">4</span>*i+<span class="hljs-number">3</span>]), Ti[<span class="hljs-number">4</span> * i + <span class="hljs-number">3</span>])), <span class="hljs-number">22</span>))

<span class="hljs-comment"># 第二轮</span>
k = <span class="hljs-number">1</span>
j = <span class="hljs-number">16</span>
<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">4</span>):
    A = add(B, shift(add(A, add(add(gfunc(B, C, D), M[(k+<span class="hljs-number">5</span>*(<span class="hljs-number">4</span>*i))%<span class="hljs-number">16</span>]), Ti[j + i * <span class="hljs-number">4</span>])), <span class="hljs-number">5</span>))
    D = add(A, shift(add(D, add(add(gfunc(A, B, C), M[(k+<span class="hljs-number">5</span>*(<span class="hljs-number">4</span>*i+<span class="hljs-number">1</span>))%<span class="hljs-number">16</span>]), Ti[j + i * <span class="hljs-number">4</span> + <span class="hljs-number">1</span>])), <span class="hljs-number">9</span>))
    C = add(D, shift(add(C, add(add(gfunc(D, A, B), M[(k+<span class="hljs-number">5</span>*(<span class="hljs-number">4</span>*i+<span class="hljs-number">2</span>))%<span class="hljs-number">16</span>]), Ti[j + i * <span class="hljs-number">4</span> + <span class="hljs-number">2</span>])), <span class="hljs-number">14</span>))
    B = add(C, shift(add(B, add(add(gfunc(C, D, A), M[(k+<span class="hljs-number">5</span>*(<span class="hljs-number">4</span>*i+<span class="hljs-number">3</span>))%<span class="hljs-number">16</span>]), Ti[j + i * <span class="hljs-number">4</span> + <span class="hljs-number">3</span>])), <span class="hljs-number">20</span>))

<span class="hljs-comment"># 第三轮</span>
k = <span class="hljs-number">5</span>
j = <span class="hljs-number">32</span>
<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">4</span>):
    A = add(B, shift(add(A, add(add(hfunc(B, C, D), M[(k+i*<span class="hljs-number">4</span>*<span class="hljs-number">3</span>)%<span class="hljs-number">16</span>]), Ti[j + i * <span class="hljs-number">4</span>])), <span class="hljs-number">4</span>))
    D = add(A, shift(add(D, add(add(hfunc(A, B, C), M[(k+(i*<span class="hljs-number">4</span>+<span class="hljs-number">1</span>)*<span class="hljs-number">3</span>)%<span class="hljs-number">16</span>]), Ti[j + i * <span class="hljs-number">4</span> + <span class="hljs-number">1</span>])), <span class="hljs-number">11</span>))
    C = add(D, shift(add(C, add(add(hfunc(D, A, B), M[(k+(i*<span class="hljs-number">4</span>+<span class="hljs-number">2</span>)*<span class="hljs-number">3</span>)%<span class="hljs-number">16</span>]), Ti[j + i * <span class="hljs-number">4</span> + <span class="hljs-number">2</span>])), <span class="hljs-number">16</span>))
    B = add(C, shift(add(B, add(add(hfunc(C, D, A), M[(k+(i*<span class="hljs-number">4</span>+<span class="hljs-number">3</span>)*<span class="hljs-number">3</span>)%<span class="hljs-number">16</span>]), Ti[j + i * <span class="hljs-number">4</span> + <span class="hljs-number">3</span>])), <span class="hljs-number">23</span>))

<span class="hljs-comment"># 第四轮</span>
k = <span class="hljs-number">0</span>
j = <span class="hljs-number">48</span>
<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">4</span>):
    A = add(B, shift(add(A, add(add(ifunc(B, C, D), M[(k+(i*<span class="hljs-number">4</span>)*<span class="hljs-number">7</span>)%<span class="hljs-number">16</span>]), Ti[j + i * <span class="hljs-number">4</span>])), <span class="hljs-number">6</span>))
    D = add(A, shift(add(D, add(add(ifunc(A, B, C), M[(k+(i*<span class="hljs-number">4</span>+<span class="hljs-number">1</span>)*<span class="hljs-number">7</span>)%<span class="hljs-number">16</span>]), Ti[j + i * <span class="hljs-number">4</span> + <span class="hljs-number">1</span>])), <span class="hljs-number">10</span>))
    C = add(D, shift(add(C, add(add(ifunc(D, A, B), M[(k+(i*<span class="hljs-number">4</span>+<span class="hljs-number">2</span>)*<span class="hljs-number">7</span>)%<span class="hljs-number">16</span>]), Ti[j + i * <span class="hljs-number">4</span> + <span class="hljs-number">2</span>])), <span class="hljs-number">15</span>))
    B = add(C, shift(add(B, add(add(ifunc(C, D, A), M[(k+(i*<span class="hljs-number">4</span>+<span class="hljs-number">3</span>)*<span class="hljs-number">7</span>)%<span class="hljs-number">16</span>]), Ti[j + i * <span class="hljs-number">4</span> + <span class="hljs-number">3</span>])), <span class="hljs-number">21</span>))
<span class="hljs-comment"># 第五步  将计算出的A,B,C,D与初始的相加，并赋值</span>
A,B,C,D = add(A, AA),add(B, BB),add(C, CC),add(D, DD)
<span class="hljs-comment"># 输出得到的密文</span>

ciphertext = reverse_order(A) + reverse_order(B) + reverse_order(C) + reverse_order(D)
cipher = ciphertext
ciphertext = <span class="hljs-built_in">str</span>(<span class="hljs-built_in">hex</span>(<span class="hljs-built_in">int</span>(ciphertext, <span class="hljs-number">2</span>))[<span class="hljs-number">2</span>:])   <span class="hljs-comment"># 将二进制数转换为十六进制数</span>
ciphertext = <span class="hljs-string">&#x27;0&#x27;</span>*(<span class="hljs-number">32</span>-<span class="hljs-built_in">len</span>(ciphertext))+ciphertext <span class="hljs-comment"># 为了避免第一个数字为零时无法显示出来</span>
print(<span class="hljs-string">&quot;hash值(小写):&quot;</span>,ciphertext)
print(<span class="hljs-string">&quot;hash值(大写):&quot;</span>,ciphertext.upper())

</code></pre></div>





<h1 id="六、综合实验"><a href="#六、综合实验" class="headerlink" title="六、综合实验"></a>六、综合实验</h1><h3 id="6-1-实验内容"><a href="#6-1-实验内容" class="headerlink" title="6.1 实验内容"></a>6.1 实验内容</h3><p>现在，Alice想通过公共信道给Bob传输一份秘密文件（文件非常大）。又知道，很多人和机构想得到这份文件。需要设计一个通信模型，来保证文件的机密性和完整性。</p>
<p>  现在很多人想要得到这份文件，那么，可能会有很多人在假冒Bob的身份，来请求得到这个文件，需要对Bob身份进行验证；也有可能是很多人得不到文件，就假冒Alice的身份，想要给Bob发送文件，如果有人发送恶意文件给Bob，Bob发现不是想要的文件，但这个文件给Bob电脑安装了后门，等他接受了正确的文件，就存在泄漏的风险，所以需要对Alice身份进行验证。</p>
<h3 id="6-2-分析实验需求"><a href="#6-2-分析实验需求" class="headerlink" title="6.2 分析实验需求"></a>6.2 分析实验需求</h3><p>现在很多人想要得到这份文件，那么，可能会有很多人在假冒Bob的身份，来请求得到这个文件，需要对Bob身份进行验证；也有可能是很多人得不到文件，就假冒Alice的身份，想要给Bob发送文件，如果有人发送恶意文件给Bob，Bob发现不是想要的文件，但这个文件给Bob电脑安装了后门，等他接受了正确的文件，就存在泄漏的风险，所以需要对Alice身份进行验证。</p>
<p><strong>根据分析，所得结果如下:</strong></p>
<ol>
<li><p>传输的是秘密文件，所以可能存在人冒充bob接收文件，所以Alice在与传输文件之前需要对bob的身份进行认证，而且bob防止被欺骗也需要对Alice的身份进行认证，这里可以采用第二类签名算法。</p>
</li>
<li><p>在确认彼此身份后需要将文件通过公共信道传输，但是可能存在攻击人劫持，所以需要对文件内容加密，而文件内容很大，考虑到加密速度问题，所以采用对称加密算法。</p>
</li>
<li><p>采用对称加密算法需要密钥，而这里使用随机生成的密钥。并且这个密钥也需要传给bob用于解密，但是公共信道不安全，所以也需要对该密钥进行加密。考虑到密钥长度不是很大，所以可以采用公钥加密算法，而且公钥加密算法可以解决传输此次加密使用的密钥，提高安全性和效率。</p>
</li>
<li><p>Bob收到密文和加密后的密钥，使用自己的私钥解密出对称加密算法使用的密钥，然后使用密钥解密密文后向Alice发送确认消息，确保bob收到消息。</p>
</li>
<li><p>确认消息也要使用到第一步使用的签名算法。</p>
</li>
</ol>
<h3 id="6-3-程序流程图"><a href="#6-3-程序流程图" class="headerlink" title="6.3 程序流程图"></a>6.3 程序流程图</h3><p><img src="https://sunzy-1304004755.cos.ap-nanjing.myqcloud.com/img/image-20210202142616269.png" srcset="/img/loading.gif" alt="image-20210202142616269"></p>
<h3 id="6-4-完整代码"><a href="#6-4-完整代码" class="headerlink" title="6.4 完整代码"></a>6.4 完整代码</h3><p>Alice</p>
<div class="hljs"><pre><code class="hljs python"><span class="hljs-comment"># -*- coding = utf - 8 -*-</span>
<span class="hljs-comment">#@Time : 2021/1/3 23:17</span>
<span class="hljs-comment">#@Author : sunzy</span>
<span class="hljs-comment">#@File : Alice.py</span>

<span class="hljs-keyword">from</span> RSA <span class="hljs-keyword">import</span> *
<span class="hljs-keyword">from</span> DES <span class="hljs-keyword">import</span> *
<span class="hljs-keyword">from</span> MD5 <span class="hljs-keyword">import</span> *
<span class="hljs-keyword">from</span> file_decode <span class="hljs-keyword">import</span> *
<span class="hljs-keyword">import</span> socket

n_bob = <span class="hljs-number">81836285346168841919828227774710209132464519960137459236348092425786962849543</span>
n = <span class="hljs-number">44531776921047477359676235110843825307036514195195627878765712056028758572817</span>
d = <span class="hljs-number">34159352569920789505556306994405309761109146525598570740717995833480670158209</span>
e = <span class="hljs-number">65537</span>

name = <span class="hljs-string">&quot;This is alice.&quot;</span>

client = socket.socket()
client.connect((<span class="hljs-string">&#x27;127.0.0.1&#x27;</span>,<span class="hljs-number">8888</span>))  <span class="hljs-comment"># 本机地址和端口</span>

data = client.recv(<span class="hljs-number">1024</span>)
print(<span class="hljs-built_in">str</span>(data, <span class="hljs-string">&quot;utf-8&quot;</span>),end=<span class="hljs-string">&quot;&quot;</span>)
client.send(<span class="hljs-string">b&#x27;1&#x27;</span>)
print(<span class="hljs-string">&quot;等待bob验证自身身份...&quot;</span>)

<span class="hljs-comment"># alice送出自己的身份信息和签名值</span>
client.send(<span class="hljs-built_in">bytes</span>(name,<span class="hljs-string">&#x27;utf-8&#x27;</span>))             <span class="hljs-comment"># alice发送身份明文信息</span>
client.recv(<span class="hljs-number">1024</span>).decode()
hash_name = md5(name)
crpto_name = <span class="hljs-built_in">str</span>(RSAEncode(hash_name, d, n)) <span class="hljs-comment"># 发送对hash值加密后的值</span>
crpto_name = <span class="hljs-built_in">bytes</span>(crpto_name,<span class="hljs-string">&#x27;utf-8&#x27;</span>)
client.send(crpto_name)

print(client.recv(<span class="hljs-number">1024</span>).decode())             <span class="hljs-comment"># 接收身份认证的结果</span>
<span class="hljs-comment">#接收bob身份hash并验证</span>
print(<span class="hljs-string">&quot;验证bob身份...&quot;</span>,end=<span class="hljs-string">&quot;&quot;</span>)
a=<span class="hljs-built_in">input</span>()

bob_name = client.recv(<span class="hljs-number">512</span>).decode()          <span class="hljs-comment"># bob发送过来的身份明文信息</span>
client.send(<span class="hljs-string">b&#x27;1&#x27;</span>)

hash_name = client.recv(<span class="hljs-number">512</span>).decode()         <span class="hljs-comment"># bob使用自己的私钥加密身份明文信息hash值后的值</span>
plain_text = RSADecode(<span class="hljs-built_in">int</span>(hash_name),e,n_bob) <span class="hljs-comment"># 使用bob的公钥解密上一步的值</span>

client.send(<span class="hljs-string">b&#x27;1&#x27;</span>)
<span class="hljs-keyword">if</span> plain_text == md5(bob_name):          <span class="hljs-comment"># 验证是不是bob</span>
    print(bob_name)
    print(<span class="hljs-string">&quot;验证通过!&quot;</span>)
<span class="hljs-keyword">else</span>:
    exit(<span class="hljs-string">&quot;验证错误!&quot;</span>)


<span class="hljs-keyword">while</span> <span class="hljs-number">1</span>:
    a = <span class="hljs-built_in">input</span>()
    bin_key = gen_key()         <span class="hljs-comment"># 随机生成64位的 DES加密明文使用的密钥</span>
    int_key = <span class="hljs-built_in">int</span>(bin_key,<span class="hljs-number">2</span>)    <span class="hljs-comment"># 将其转换为十进制数，便于后面使用RSA算法加密</span>
    print(<span class="hljs-string">&quot;随机产生对称密钥:&quot;</span>,int_key)  <span class="hljs-comment"># 每次传输随机产生一个密钥更加安全</span>

    plain = read_file()    <span class="hljs-comment"># 读取文件内容</span>
    bin_cipher = DES_encode(plain, bin_key) <span class="hljs-comment"># 使用DES算法加密内容</span>

    a = <span class="hljs-built_in">input</span>()
    int_key = fast_mod(int_key,e,n_bob)   <span class="hljs-comment"># 加密DES的密钥 e是bob的公钥</span>
    print(<span class="hljs-string">&quot;加密对称密钥&quot;</span>)

    print(<span class="hljs-string">&quot;传输密钥...&quot;</span>)               <span class="hljs-comment"># 传输加密后DES密钥</span>
    client.sendall(<span class="hljs-built_in">bytes</span>(<span class="hljs-built_in">str</span>(int_key),<span class="hljs-string">&quot;utf-8&quot;</span>))
    client.recv(<span class="hljs-number">512</span>)

    length = <span class="hljs-built_in">str</span>(<span class="hljs-built_in">len</span>(bin_cipher))     <span class="hljs-comment"># 传输发送内容的长度</span>
    length = <span class="hljs-built_in">bytes</span>(length,<span class="hljs-string">&quot;utf-8&quot;</span>)    <span class="hljs-comment"># 方便其接收</span>
    client.send(length)

    print(<span class="hljs-string">&quot;传输密文...&quot;</span>)
    client.sendall(<span class="hljs-built_in">bytes</span>(<span class="hljs-built_in">str</span>(bin_cipher),<span class="hljs-string">&quot;utf-8&quot;</span>)) <span class="hljs-comment">#发送密文</span>
    message = client.recv(<span class="hljs-number">512</span>).decode()
    client.send(<span class="hljs-string">b&#x27;1&#x27;</span>)
    crypt_message = client.recv(<span class="hljs-number">512</span>).decode()
    hash_message = RSADecode(<span class="hljs-built_in">int</span>(crypt_message),e,n_bob)
    <span class="hljs-keyword">if</span> hash_message == md5(message):
        print(message)
    print(<span class="hljs-string">&quot;文件传输结束！&quot;</span>)
    <span class="hljs-keyword">break</span>
client.close()</code></pre></div>



<p>Bob</p>
<div class="hljs"><pre><code class="hljs python"><span class="hljs-comment"># -*- coding = utf - 8 -*-</span>
<span class="hljs-comment">#@Time : 2021/1/3 23:17</span>
<span class="hljs-comment">#@Author : sunzy</span>
<span class="hljs-comment">#@File : bob.py</span>

<span class="hljs-keyword">import</span> socket
<span class="hljs-keyword">import</span> libnum
<span class="hljs-keyword">from</span> RSA <span class="hljs-keyword">import</span> *
<span class="hljs-keyword">from</span> DES <span class="hljs-keyword">import</span> *
<span class="hljs-keyword">from</span> MD5 <span class="hljs-keyword">import</span> *

name = <span class="hljs-string">&quot;This is bob.&quot;</span>


n = <span class="hljs-number">81836285346168841919828227774710209132464519960137459236348092425786962849543</span>
n_alice = <span class="hljs-number">44531776921047477359676235110843825307036514195195627878765712056028758572817</span>
d = <span class="hljs-number">39540198292360595989919600111176873707392294831248672388670326288876701993673</span>
e = <span class="hljs-number">65537</span>

<span class="hljs-comment"># e_alice = 2081</span>

server = socket.socket() <span class="hljs-comment">#创建对象</span>
server.bind((<span class="hljs-string">&quot;localhost&quot;</span>,<span class="hljs-number">8888</span>))<span class="hljs-comment">#绑定 ip和端口</span>
server.listen()  <span class="hljs-comment">#监听</span>
<span class="hljs-comment">#等待连接</span>
print(<span class="hljs-string">&#x27;Waiting connection...&#x27;</span>)
<span class="hljs-comment">#接受请求，返回套接字对象和IP+端口号</span>
con,addr = server.accept()
con.send(<span class="hljs-built_in">bytes</span>(<span class="hljs-string">&quot;Welcome connect!\n开始加密传输:\n&quot;</span>,<span class="hljs-string">&quot;utf-8&quot;</span>))
con.recv(<span class="hljs-number">1024</span>)

<span class="hljs-comment"># 验证alice身份</span>
print(<span class="hljs-string">&quot;验证alice身份...&quot;</span>)
a = <span class="hljs-built_in">input</span>()
alice_name = con.recv(<span class="hljs-number">512</span>).decode()  <span class="hljs-comment"># alice 的明文信息</span>
con.send(<span class="hljs-string">b&#x27;1&#x27;</span>)
hash_name = con.recv(<span class="hljs-number">512</span>).decode()   <span class="hljs-comment"># alice 用私钥加密明文的hash值</span>
plain_text = RSADecode(<span class="hljs-built_in">int</span>(hash_name),e,n_alice) <span class="hljs-comment"># 用alice 的公钥解密出hash值</span>
<span class="hljs-keyword">if</span> plain_text == md5(alice_name):   <span class="hljs-comment"># 判断上一步的值与md5函数加密是否相同</span>
    print(alice_name)               <span class="hljs-comment"># 如果二者相同则可以保证对方是alice,这里的安全性是由公钥算法和hash函数保证</span>
    print(<span class="hljs-string">&quot;验证通过！&quot;</span>)               <span class="hljs-comment"># 因为只有alice有自己的私钥，hash函数的存在防止伪造明文攻击</span>
    con.send(<span class="hljs-built_in">bytes</span>(<span class="hljs-string">&quot;您通过了验证!&quot;</span>,<span class="hljs-string">&quot;utf-8&quot;</span>))
<span class="hljs-keyword">else</span>:
    exit(<span class="hljs-string">&quot;这不是alice,验证错误！&quot;</span>)
<span class="hljs-comment">#送出自己的身份信息和签名值</span>
print(<span class="hljs-string">&quot;等待alice验证自身身份...&quot;</span>)

con.send(<span class="hljs-built_in">bytes</span>(name,<span class="hljs-string">&#x27;utf-8&#x27;</span>))    <span class="hljs-comment"># 向alice发送身份信息的明文</span>
con.recv(<span class="hljs-number">1024</span>).decode()

hash_name = md5(name)            <span class="hljs-comment"># 明文信息的hash值</span>
crpto_name = <span class="hljs-built_in">str</span>(RSAEncode(hash_name, d, n))  <span class="hljs-comment"># 使用自己的私钥加密上一步的hash值</span>
crpto_name = <span class="hljs-built_in">bytes</span>(crpto_name,<span class="hljs-string">&#x27;utf-8&#x27;</span>)        <span class="hljs-comment"># 发送给alice</span>
con.send(crpto_name)
con.recv(<span class="hljs-number">1024</span>)

<span class="hljs-keyword">while</span> <span class="hljs-number">1</span>:
    data = con.recv(<span class="hljs-number">1024</span>)    <span class="hljs-comment"># 接收alice发送的使用公钥算法加密后的DES的密钥</span>
    data = data.decode()
    int_key = <span class="hljs-built_in">int</span>(data)
    print(<span class="hljs-string">&quot;被加密后的密钥:&quot;</span>,int_key)
    int_key = fast_mod(int_key, d, n)  <span class="hljs-comment"># 使用私钥d解密出DES密钥</span>
    print(<span class="hljs-string">&quot;解密后的密钥&quot;</span>, int_key)

    print(<span class="hljs-string">&quot;----&quot;</span>*<span class="hljs-number">10</span>)         <span class="hljs-comment"># 接收密文的长度（为了方便存储）</span>
    con.send(<span class="hljs-string">b&#x27;1&#x27;</span>)
    length = con.recv(<span class="hljs-number">1024</span>)
    length = <span class="hljs-built_in">int</span>(length.decode())
    buff = []
    size = <span class="hljs-number">0</span>
    <span class="hljs-keyword">while</span> size &lt; length:    <span class="hljs-comment"># 开始接受密文</span>
        dat = con.recv(<span class="hljs-number">1024</span>)
        size += <span class="hljs-built_in">len</span>(dat.decode())
        buff.append(dat)
    data = <span class="hljs-string">b&#x27;&#x27;</span>.join(buff)
    bin_cipher = data.decode()

    cipher = bin_to_str(bin_cipher)
    bin_key = <span class="hljs-built_in">bin</span>(int_key)[<span class="hljs-number">2</span>:]      <span class="hljs-comment"># 将密钥转换成二进制数</span>
    print(<span class="hljs-string">&quot;解密传输内容:&quot;</span>)
    print(libnum.b2s(DES_decode(cipher, bin_key))) <span class="hljs-comment">#打印出解密后的明文</span>
    message = <span class="hljs-string">&quot;Bob received the file successfully!&quot;</span>
    con.send(<span class="hljs-built_in">bytes</span>(message,<span class="hljs-string">&#x27;utf-8&#x27;</span>))
    con.recv(<span class="hljs-number">1024</span>).decode()
    hash_message = md5(message)
    crypt_message = <span class="hljs-built_in">str</span>(RSAEncode(hash_message,d,n))
    con.send(<span class="hljs-built_in">bytes</span>(crypt_message,<span class="hljs-string">&#x27;utf-8&#x27;</span>))
    <span class="hljs-keyword">break</span>

server.close()</code></pre></div>



<p>file_decode</p>
<div class="hljs"><pre><code class="hljs python"><span class="hljs-comment"># -*- coding = utf - 8 -*-</span>
<span class="hljs-comment">#@Time : 2021/1/3 23:17</span>
<span class="hljs-comment">#@Author : sunzy</span>
<span class="hljs-comment">#@File : file_decode.py</span>


<span class="hljs-keyword">import</span> random
<span class="hljs-keyword">import</span> socket
<span class="hljs-keyword">import</span> re
<span class="hljs-keyword">from</span> RSA <span class="hljs-keyword">import</span> *
<span class="hljs-keyword">from</span> DES <span class="hljs-keyword">import</span> *
<span class="hljs-keyword">from</span> MD5 <span class="hljs-keyword">import</span> *

<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">gen_key</span>():</span>  <span class="hljs-comment"># 生成64位的对称加密的密钥</span>
    <span class="hljs-built_in">list</span> = []
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">64</span>):
        c = random.choice([<span class="hljs-string">&#x27;0&#x27;</span>, <span class="hljs-string">&#x27;1&#x27;</span>])
        <span class="hljs-built_in">list</span>.append(c)
    res = <span class="hljs-string">&quot;&quot;</span>.join(<span class="hljs-built_in">list</span>)
    <span class="hljs-keyword">return</span> res

<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">read_file</span>():</span>
    <span class="hljs-keyword">try</span>:
        f = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;text.txt&#x27;</span>,<span class="hljs-string">&#x27;r&#x27;</span>, encoding = <span class="hljs-string">&#x27;utf-8&#x27;</span>)
        text = f.read()
        f.close()
        print(<span class="hljs-string">&quot;读取成功!&quot;</span>)
        <span class="hljs-keyword">return</span> text
    <span class="hljs-keyword">except</span> IOError:
        print(<span class="hljs-string">&quot;读取错误!&quot;</span>)


<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">bin_to_str</span>(<span class="hljs-params">bin_str</span>) :</span>   <span class="hljs-comment"># 8位二进制转字符，用于bob收到密后使用</span>
    res = <span class="hljs-string">&quot;&quot;</span>
    tmp = re.findall(<span class="hljs-string">r&#x27;.&#123;8&#125;&#x27;</span>,bin_str)
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> tmp :
        res += <span class="hljs-built_in">chr</span>(<span class="hljs-built_in">int</span>(i,<span class="hljs-number">2</span>))
    <span class="hljs-keyword">return</span> res</code></pre></div>


            </div>
            <hr>
            <div>
              <div class="post-metas mb-3">
                
                
                  <div class="post-meta">
                    <i class="iconfont icon-tags"></i>
                    
                      <a class="hover-with-bg" href="/tags/%E5%8F%A4%E5%85%B8%E5%AF%86%E7%A0%81/">古典密码</a>
                    
                      <a class="hover-with-bg" href="/tags/DES/">DES</a>
                    
                      <a class="hover-with-bg" href="/tags/RSA/">RSA</a>
                    
                      <a class="hover-with-bg" href="/tags/MD5/">MD5</a>
                    
                  </div>
                
              </div>
              
                <p class="note note-warning">本博客所有文章除特别声明外，均采用 <a target="_blank" href="https://creativecommons.org/licenses/by-sa/4.0/deed.zh" rel="nofollow noopener noopener">CC BY-SA 4.0 协议</a> ，转载请注明出处！</p>
              
              
                <div class="post-prevnext row">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2021/03/03/net-a-and-d/">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">net_a_and_d</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2020/11/15/xss-sql/">
                        <span class="hidden-mobile">xss和sql注入简单环境的搭建</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
              <!-- Comments -->
              <article class="comments" id="comments">
                
                
  <div id="vcomments"></div>
  <script type="text/javascript">
    function loadValine() {
      addScript('https://cdn.jsdelivr.net/gh/HCLonely/Valine@latest/dist/Valine.min.js', function () {
        new Valine({
          el: "#vcomments",
          app_id: "2rPljbm5WOxA9BCPXqy3VE5y-gzGzoHsz",
          app_key: "SCoIn2Qp99a7ITtPhkAi6Chw",
          placeholder: "说点什么吧~~~",
          path: window.location.pathname,
          avatar: "retro",
          meta: ["nick","mail","link"],
          pageSize: "10",
          lang: "zh-CN",
          highlight: true,
          recordIP: false,
          serverURLs: "",
          master: "4cd096660a71d786a2a4d9d0bb4e8996",
          friends: "b275f0fc8103331da645a878cf60f841",
          tagMeta: ["博主","友人","访客"],
        });
      });
    }
    waitElementVisible('vcomments', loadValine);
  </script>
  <noscript>Please enable JavaScript to view the <a target="_blank" href="https://valine.js.org" rel="nofollow noopener noopener">comments
      powered by Valine.</a></noscript>


              </article>
            
          </article>
        </div>
      </div>
    </div>
    
      <div class="d-none d-lg-block col-lg-2 toc-container" id="toc-ctn">
        <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;目录</p>
  <div id="tocbot"></div>
</div>

      </div>
    
  </div>
</div>

<!-- Custom -->

  <div class="col-lg-7 mx-auto nopadding-md">
    <div class="container custom post-content mx-auto">
      <img src="https://octodex.github.com/images/jetpacktocat.png" srcset="/img/loading.gif" class="rounded mx-auto d-block mt-5" style="width:150px; height:150px;">
    </div>
  </div>


    
  </main>

  
    <a id="scroll-top-button" href="#" role="button">
      <i class="iconfont icon-arrowup" aria-hidden="true"></i>
    </a>
  

  
    <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v"
                 for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>
  

  

  <footer class="text-center mt-5 py-3">
  <div class="footer-content">
     <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
  </div>
  
  <div class="statistics">
    
    

    
      
        <!-- 不蒜子统计PV -->
        <span id="busuanzi_container_site_pv" style="display: none">
            总访问量 
            <span id="busuanzi_value_site_pv"></span>
             次
          </span>
      
      
        <!-- 不蒜子统计UV -->
        <span id="busuanzi_container_site_uv" style="display: none">
            总访客数 
            <span id="busuanzi_value_site_uv"></span>
             人
          </span>
      
    
  </div>


  

  
</footer>

<!-- SCRIPTS -->
<script  src="https://cdn.staticfile.org/jquery/3.4.1/jquery.min.js" ></script>
<script  src="https://cdn.staticfile.org/twitter-bootstrap/4.4.1/js/bootstrap.min.js" ></script>
<script  src="/js/debouncer.js" ></script>
<script  src="/js/main.js" ></script>

<!-- Plugins -->


  
    <script  src="/js/lazyload.js" ></script>
  



  



  <script defer src="https://cdn.staticfile.org/clipboard.js/2.0.6/clipboard.min.js" ></script>
  <script  src="/js/clipboard-use.js" ></script>



  <script defer src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" ></script>





  <script  src="https://cdn.staticfile.org/tocbot/4.11.1/tocbot.min.js" ></script>
  <script>
    $(document).ready(function () {
      var boardCtn = $('#board-ctn');
      var boardTop = boardCtn.offset().top;

      tocbot.init({
        tocSelector: '#tocbot',
        contentSelector: '#post-body',
        headingSelector: 'h1,h2,h3,h4,h5,h6',
        linkClass: 'tocbot-link',
        activeLinkClass: 'tocbot-active-link',
        listClass: 'tocbot-list',
        isCollapsedClass: 'tocbot-is-collapsed',
        collapsibleClass: 'tocbot-is-collapsible',
        collapseDepth: 0,
        scrollSmooth: true,
        headingsOffset: -boardTop
      });
      if ($('.toc-list-item').length > 0) {
        $('#toc').css('visibility', 'visible');
      }
    });
  </script>



  <script  src="https://cdn.staticfile.org/typed.js/2.0.11/typed.min.js" ></script>
  <script>
    var typed = new Typed('#subtitle', {
      strings: [
        '  ',
        "密码学&nbsp;",
      ],
      cursorChar: "_",
      typeSpeed: 70,
      loop: true,
    });
    typed.stop();
    $(document).ready(function () {
      $(".typed-cursor").addClass("h2");
      typed.start();
    });
  </script>



  <script  src="https://cdn.staticfile.org/anchor-js/4.2.2/anchor.min.js" ></script>
  <script>
    anchors.options = {
      placement: "right",
      visible: "hover",
      
      icon: "§"
      
    };
    var el = "h1,h2,h3,h4,h5,h6".split(",");
    var res = [];
    for (item of el) {
      res.push(".markdown-body > " + item)
    }
    anchors.add(res.join(", "))
  </script>



  <script  src="/js/local-search.js" ></script>
  <script>
    var path = "/local-search.xml";
    var inputArea = document.querySelector("#local-search-input");
    inputArea.onclick = function () {
      searchFunc(path, 'local-search-input', 'local-search-result');
      this.onclick = null
    }
  </script>



  <script  src="https://cdn.staticfile.org/fancybox/3.5.7/jquery.fancybox.min.js" ></script>
  <link  rel="stylesheet" href="https://cdn.staticfile.org/fancybox/3.5.7/jquery.fancybox.min.css" />

  <script>
    $('#post img:not(.no-zoom img, img[no-zoom]), img[zoom]').each(
      function () {
        var element = document.createElement('a');
        $(element).attr('data-fancybox', 'images');
        $(element).attr('href', $(this).attr('src'));
        $(this).wrap(element);
      }
    );
  </script>












  

  

  

  

  

  



<div class="text-center py-1">   
  <div>
    <span>Copyright © 2020</span></a>
    <a href="http://sunzy.icu/" target="_blank" rel="nofollow noopener">
     <span>my blog</span></a>    <br>
  </div>
<div>
  <span id="timeDate">载入天数...</span>
  <span id="times">载入时分秒...</span>
  <script>
  var now = new Date();
  function createtime(){
      var grt= new Date("03/02/2020 00:00:00");//此处修改你的建站时间或者网站上线时间
      now.setTime(now.getTime()+250);
      days = (now - grt ) / 1000 / 60 / 60 / 24;
      dnum = Math.floor(days);
      hours = (now - grt ) / 1000 / 60 / 60 - (24 * dnum);
      hnum = Math.floor(hours);
      if(String(hnum).length ==1 ){
          hnum = "0" + hnum;
      }
      minutes = (now - grt ) / 1000 /60 - (24 * 60 * dnum) - (60 * hnum);
      mnum = Math.floor(minutes);
      if(String(mnum).length ==1 ){
                mnum = "0" + mnum;
      }
      seconds = (now - grt ) / 1000 - (24 * 60 * 60 * dnum) - (60 * 60 * hnum) - (60 * mnum);
      snum = Math.round(seconds);
      if(String(snum).length ==1 ){
                snum = "0" + snum;
      }
      document.getElementById("timeDate").innerHTML = "🚀 for&nbsp"+dnum+"&nbspdays";  //此次自定义显示内容
      document.getElementById("times").innerHTML = hnum + "&nbsphr&nbsp" + mnum + "&nbspmin&nbsp" + snum + "&nbspsec";
  }  //此次自定义显示内容
  setInterval("createtime()",250);
  </script>
</div>

<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"model":{"jsonPath":"/live2dw/assets/wanko.model.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":false},"log":false});</script></body>
</html>
